<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BangPatterns                             #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DataKinds                                #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric                            #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts                         #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE MultiWayIf                               #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards                          #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables                      #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications                         #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies                             #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators                            #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE ViewPatterns                             #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# OPTIONS_GHC -fplugin GHC.TypeLits.KnownNat.Solver #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# OPTIONS_GHC -fplugin GHC.TypeLits.Normalise       #-}</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- Module      : Numeric.HHT</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- Copyright   : (c) Justin Le 2018</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- License     : BSD3</span><span>
</span><span id="line-19"></span><span class="hs-comment">--</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- Maintainer  : justin@jle.im</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- Stability   : experimental</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- Portability : non-portable</span><span>
</span><span id="line-23"></span><span class="hs-comment">--</span><span>
</span><span id="line-24"></span><span class="hs-comment">-- Hilbert-Huang transform in pure Haskell.</span><span>
</span><span id="line-25"></span><span class="hs-comment">--</span><span>
</span><span id="line-26"></span><span class="hs-comment">-- The main data type is 'HHT', which can be generated using 'hht' or</span><span>
</span><span id="line-27"></span><span class="hs-comment">-- 'hhtEmd'.  See &quot;Numeric.EMD&quot; for information on why this module uses</span><span>
</span><span id="line-28"></span><span class="hs-comment">-- &quot;sized vectors&quot;, and how to convert unsized vectors to sized vectors.</span><span>
</span><span id="line-29"></span><span class="hs-comment">--</span><span>
</span><span id="line-30"></span><span class="hs-comment">-- @since 0.1.2.0</span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Numeric.HHT</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-33"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Hilbert-Huang Transform</span></span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><a href="Numeric.HHT.html#HHT"><span class="hs-identifier">HHT</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.HHT.html#HHTLine"><span class="hs-identifier">HHTLine</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.HHT.html#hhtEmd"><span class="hs-identifier">hhtEmd</span></a></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.HHT.html#hht"><span class="hs-identifier">hht</span></a></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.HHT.html#ihhtEmd"><span class="hs-identifier">ihhtEmd</span></a></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.HHT.html#ihht"><span class="hs-identifier">ihht</span></a></span><span>
</span><span id="line-39"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Hilbert-Huang Spectrum</span></span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.HHT.html#hhtSpectrum"><span class="hs-identifier">hhtSpectrum</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.HHT.html#hhtSparseSpectrum"><span class="hs-identifier">hhtSparseSpectrum</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.HHT.html#hhtDenseSpectrum"><span class="hs-identifier">hhtDenseSpectrum</span></a></span><span>
</span><span id="line-41"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Properties of spectrum</span></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.HHT.html#meanMarginal"><span class="hs-identifier">meanMarginal</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.HHT.html#marginal"><span class="hs-identifier">marginal</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.HHT.html#instantaneousEnergy"><span class="hs-identifier">instantaneousEnergy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.HHT.html#degreeOfStationarity"><span class="hs-identifier">degreeOfStationarity</span></a></span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.HHT.html#expectedFreq"><span class="hs-identifier">expectedFreq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.HHT.html#dominantFreq"><span class="hs-identifier">dominantFreq</span></a></span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.HHT.html#foldFreq"><span class="hs-identifier">foldFreq</span></a></span><span>
</span><span id="line-45"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Options</span></span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.EMD.Internal.Sift.html#EMDOpts"><span class="hs-identifier">EMDOpts</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.EMD.Internal.Sift.html#defaultEO"><span class="hs-identifier">defaultEO</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.EMD.Internal.Sift.html#BoundaryHandler"><span class="hs-identifier">BoundaryHandler</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.EMD.Internal.Sift.html#SiftCondition"><span class="hs-identifier">SiftCondition</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.EMD.Internal.Sift.html#defaultSC"><span class="hs-identifier">defaultSC</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.EMD.Internal.Spline.html#SplineEnd"><span class="hs-identifier">SplineEnd</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Hilbert transforms (internal usage)</span></span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.HHT.html#hilbert"><span class="hs-identifier">hilbert</span></a></span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.HHT.html#hilbertIm"><span class="hs-identifier">hilbertIm</span></a></span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.HHT.html#hilbertPolar"><span class="hs-identifier">hilbertPolar</span></a></span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.HHT.html#hilbertMagFreq"><span class="hs-identifier">hilbertMagFreq</span></a></span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Complex</span></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Finite</span></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Fixed</span></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Proxy</span></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Semigroup</span></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">GHC.TypeNats</span></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Numeric.EMD.html"><span class="hs-identifier">Numeric.EMD</span></a></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Numeric.HHT.Internal.FFT.html"><span class="hs-identifier">Numeric.HHT.Internal.FFT</span></a></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Binary</span></span><span>               </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Bi</span></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span>                  </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector.Generic</span></span><span>       </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">VG</span></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector.Generic.Sized</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">SVG</span></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector.Sized</span></span><span>         </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">SV</span></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Math.FFT.Base</span></span><span>             </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">FFT</span></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-comment">-- | A Hilbert Trasnform of a given IMF, given as a &quot;skeleton line&quot;.</span><span>
</span><span id="line-73"></span><span id="local-6989586621679184520"><span id="local-6989586621679184521"></span></span><span class="hs-keyword">data</span><span> </span><span id="HHTLine"><span class="annot"><a href="Numeric.HHT.html#HHTLine"><span class="hs-identifier hs-var">HHTLine</span></a></span></span><span> </span><span id="local-6989586621679184757"><span class="annot"><a href="#local-6989586621679184757"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621679184756"><span class="annot"><a href="#local-6989586621679184756"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621679184755"><span class="annot"><a href="#local-6989586621679184755"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="HHTLine"><span class="annot"><a href="Numeric.HHT.html#HHTLine"><span class="hs-identifier hs-var">HHTLine</span></a></span></span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- | IMF HHT Magnitude as a time series.</span><span>
</span><span id="line-75"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-76"></span><span>      </span><span class="hs-comment">-- It may be useful to &quot;zip&quot; this vector with 'hlFreqs'.  To do this,</span><span>
</span><span id="line-77"></span><span>      </span><span class="hs-comment">-- use a function like 'SVG.init' or 'SVG.tail' to make these two</span><span>
</span><span id="line-78"></span><span>      </span><span class="hs-comment">-- vectors contain the same length, or 'weaken'/'shift' to make</span><span>
</span><span id="line-79"></span><span>      </span><span class="hs-comment">-- indices in 'hlFreqs' usable as indices in 'hlMags'.</span><span>
</span><span id="line-80"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-81"></span><span>      </span><span class="hs-comment">-- Prior to v0.1.9.0, this was a length-n vector, just like</span><span>
</span><span id="line-82"></span><span>      </span><span class="hs-comment">-- 'hlFreqs'.  To get the same behavior, use 'SVG.init' on this new</span><span>
</span><span id="line-83"></span><span>      </span><span class="hs-comment">-- field's value.</span><span>
</span><span id="line-84"></span><span>      </span><span id="hlMags"><span class="annot"><span class="annottext">HHTLine v n a -&gt; Vector v (n + 1) a
</span><a href="Numeric.HHT.html#hlMags"><span class="hs-identifier hs-var hs-var">hlMags</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SVG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184757"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679184756"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679184755"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>      </span><span class="hs-comment">-- | IMF HHT instantaneous frequency as a time series (between 0 and 1).</span><span>
</span><span id="line-86"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-87"></span><span>      </span><span class="hs-comment">-- In reality, these frequencies are the frequencies &quot;in between&quot;</span><span>
</span><span id="line-88"></span><span>      </span><span class="hs-comment">-- each step in 'hlMags'.</span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="hlFreqs"><span class="annot"><span class="annottext">HHTLine v n a -&gt; Vector v n a
</span><a href="Numeric.HHT.html#hlFreqs"><span class="hs-identifier hs-var hs-var">hlFreqs</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SVG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184757"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184756"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184755"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>      </span><span class="hs-comment">-- | Initial phase of skeleton line (between -pi and pi)</span><span>
</span><span id="line-91"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-92"></span><span>      </span><span class="hs-comment">-- @since 0.1.9.0</span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="hlInitPhase"><span class="annot"><span class="annottext">HHTLine v n a -&gt; a
</span><a href="Numeric.HHT.html#hlInitPhase"><span class="hs-identifier hs-var hs-var">hlInitPhase</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679184755"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679184510"><span id="local-6989586621679184512"><span id="local-6989586621679184514"><span class="annot"><span class="annottext">Int -&gt; HHTLine v n a -&gt; ShowS
[HHTLine v n a] -&gt; ShowS
HHTLine v n a -&gt; String
(Int -&gt; HHTLine v n a -&gt; ShowS)
-&gt; (HHTLine v n a -&gt; String)
-&gt; ([HHTLine v n a] -&gt; ShowS)
-&gt; Show (HHTLine v n a)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall (v :: * -&gt; *) (n :: Nat) a.
(Show a, Show (v a)) =&gt;
Int -&gt; HHTLine v n a -&gt; ShowS
forall (v :: * -&gt; *) (n :: Nat) a.
(Show a, Show (v a)) =&gt;
[HHTLine v n a] -&gt; ShowS
forall (v :: * -&gt; *) (n :: Nat) a.
(Show a, Show (v a)) =&gt;
HHTLine v n a -&gt; String
showList :: [HHTLine v n a] -&gt; ShowS
$cshowList :: forall (v :: * -&gt; *) (n :: Nat) a.
(Show a, Show (v a)) =&gt;
[HHTLine v n a] -&gt; ShowS
show :: HHTLine v n a -&gt; String
$cshow :: forall (v :: * -&gt; *) (n :: Nat) a.
(Show a, Show (v a)) =&gt;
HHTLine v n a -&gt; String
showsPrec :: Int -&gt; HHTLine v n a -&gt; ShowS
$cshowsPrec :: forall (v :: * -&gt; *) (n :: Nat) a.
(Show a, Show (v a)) =&gt;
Int -&gt; HHTLine v n a -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679184505"><span id="local-6989586621679184507"><span class="annot"><span class="annottext">HHTLine v n a -&gt; HHTLine v n a -&gt; Bool
(HHTLine v n a -&gt; HHTLine v n a -&gt; Bool)
-&gt; (HHTLine v n a -&gt; HHTLine v n a -&gt; Bool) -&gt; Eq (HHTLine v n a)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall (v :: * -&gt; *) (n :: Nat) a.
(Eq a, Eq (v a)) =&gt;
HHTLine v n a -&gt; HHTLine v n a -&gt; Bool
/= :: HHTLine v n a -&gt; HHTLine v n a -&gt; Bool
$c/= :: forall (v :: * -&gt; *) (n :: Nat) a.
(Eq a, Eq (v a)) =&gt;
HHTLine v n a -&gt; HHTLine v n a -&gt; Bool
== :: HHTLine v n a -&gt; HHTLine v n a -&gt; Bool
$c== :: forall (v :: * -&gt; *) (n :: Nat) a.
(Eq a, Eq (v a)) =&gt;
HHTLine v n a -&gt; HHTLine v n a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679184489"><span id="local-6989586621679184491"><span id="local-6989586621679184493"><span id="local-6989586621679184495"><span id="local-6989586621679184497"><span id="local-6989586621679184499"><span id="local-6989586621679184501"><span class="annot"><span class="annottext">Eq (HHTLine v n a)
Eq (HHTLine v n a) =&gt;
(HHTLine v n a -&gt; HHTLine v n a -&gt; Ordering)
-&gt; (HHTLine v n a -&gt; HHTLine v n a -&gt; Bool)
-&gt; (HHTLine v n a -&gt; HHTLine v n a -&gt; Bool)
-&gt; (HHTLine v n a -&gt; HHTLine v n a -&gt; Bool)
-&gt; (HHTLine v n a -&gt; HHTLine v n a -&gt; Bool)
-&gt; (HHTLine v n a -&gt; HHTLine v n a -&gt; HHTLine v n a)
-&gt; (HHTLine v n a -&gt; HHTLine v n a -&gt; HHTLine v n a)
-&gt; Ord (HHTLine v n a)
HHTLine v n a -&gt; HHTLine v n a -&gt; Bool
HHTLine v n a -&gt; HHTLine v n a -&gt; Ordering
HHTLine v n a -&gt; HHTLine v n a -&gt; HHTLine v n a
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall (v :: * -&gt; *) (n :: Nat) a.
(Ord a, Ord (v a)) =&gt;
Eq (HHTLine v n a)
forall (v :: * -&gt; *) (n :: Nat) a.
(Ord a, Ord (v a)) =&gt;
HHTLine v n a -&gt; HHTLine v n a -&gt; Bool
forall (v :: * -&gt; *) (n :: Nat) a.
(Ord a, Ord (v a)) =&gt;
HHTLine v n a -&gt; HHTLine v n a -&gt; Ordering
forall (v :: * -&gt; *) (n :: Nat) a.
(Ord a, Ord (v a)) =&gt;
HHTLine v n a -&gt; HHTLine v n a -&gt; HHTLine v n a
min :: HHTLine v n a -&gt; HHTLine v n a -&gt; HHTLine v n a
$cmin :: forall (v :: * -&gt; *) (n :: Nat) a.
(Ord a, Ord (v a)) =&gt;
HHTLine v n a -&gt; HHTLine v n a -&gt; HHTLine v n a
max :: HHTLine v n a -&gt; HHTLine v n a -&gt; HHTLine v n a
$cmax :: forall (v :: * -&gt; *) (n :: Nat) a.
(Ord a, Ord (v a)) =&gt;
HHTLine v n a -&gt; HHTLine v n a -&gt; HHTLine v n a
&gt;= :: HHTLine v n a -&gt; HHTLine v n a -&gt; Bool
$c&gt;= :: forall (v :: * -&gt; *) (n :: Nat) a.
(Ord a, Ord (v a)) =&gt;
HHTLine v n a -&gt; HHTLine v n a -&gt; Bool
&gt; :: HHTLine v n a -&gt; HHTLine v n a -&gt; Bool
$c&gt; :: forall (v :: * -&gt; *) (n :: Nat) a.
(Ord a, Ord (v a)) =&gt;
HHTLine v n a -&gt; HHTLine v n a -&gt; Bool
&lt;= :: HHTLine v n a -&gt; HHTLine v n a -&gt; Bool
$c&lt;= :: forall (v :: * -&gt; *) (n :: Nat) a.
(Ord a, Ord (v a)) =&gt;
HHTLine v n a -&gt; HHTLine v n a -&gt; Bool
&lt; :: HHTLine v n a -&gt; HHTLine v n a -&gt; Bool
$c&lt; :: forall (v :: * -&gt; *) (n :: Nat) a.
(Ord a, Ord (v a)) =&gt;
HHTLine v n a -&gt; HHTLine v n a -&gt; Bool
compare :: HHTLine v n a -&gt; HHTLine v n a -&gt; Ordering
$ccompare :: forall (v :: * -&gt; *) (n :: Nat) a.
(Ord a, Ord (v a)) =&gt;
HHTLine v n a -&gt; HHTLine v n a -&gt; Ordering
$cp1Ord :: forall (v :: * -&gt; *) (n :: Nat) a.
(Ord a, Ord (v a)) =&gt;
Eq (HHTLine v n a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. HHTLine v n a -&gt; Rep (HHTLine v n a) x)
-&gt; (forall x. Rep (HHTLine v n a) x -&gt; HHTLine v n a)
-&gt; Generic (HHTLine v n a)
forall x. Rep (HHTLine v n a) x -&gt; HHTLine v n a
forall x. HHTLine v n a -&gt; Rep (HHTLine v n a) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall (v :: * -&gt; *) (n :: Nat) a x.
Rep (HHTLine v n a) x -&gt; HHTLine v n a
forall (v :: * -&gt; *) (n :: Nat) a x.
HHTLine v n a -&gt; Rep (HHTLine v n a) x
$cto :: forall (v :: * -&gt; *) (n :: Nat) a x.
Rep (HHTLine v n a) x -&gt; HHTLine v n a
$cfrom :: forall (v :: * -&gt; *) (n :: Nat) a x.
HHTLine v n a -&gt; Rep (HHTLine v n a) x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="hs-comment">-- | @since 0.1.3.0</span><span>
</span><span id="line-98"></span><span id="local-6989586621679184482"><span id="local-6989586621679184483"><span id="local-6989586621679184484"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679184476"><span id="local-6989586621679184478"><span id="local-6989586621679184480"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184484"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184483"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679184482"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bi.Binary</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679184484"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184483"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bi.Binary</span></span><span> </span><span class="annot"><a href="#local-6989586621679184483"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bi.Binary</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.HHT.html#HHTLine"><span class="hs-identifier hs-type">HHTLine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184484"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184482"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184483"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-comment">-- | @since 0.1.5.0</span><span>
</span><span id="line-101"></span><span id="local-6989586621679184472"><span id="local-6989586621679184473"><span id="local-6989586621679184474"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679184470"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679184474"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184473"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="#local-6989586621679184473"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.HHT.html#HHTLine"><span class="hs-identifier hs-type">HHTLine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184474"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184472"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184473"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="hs-comment">-- | A Hilbert-Huang Transform.  An @'HHT' v n a@ is a Hilbert-Huang</span><span>
</span><span id="line-104"></span><span class="hs-comment">-- transform of an @n@-item time series of items of type @a@ represented</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- using vector @v@.</span><span>
</span><span id="line-106"></span><span class="hs-comment">--</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- Create using 'hht' or 'hhtEmd'.</span><span>
</span><span id="line-108"></span><span id="local-6989586621679184467"><span id="local-6989586621679184468"></span></span><span class="hs-keyword">data</span><span> </span><span id="HHT"><span class="annot"><a href="Numeric.HHT.html#HHT"><span class="hs-identifier hs-var">HHT</span></a></span></span><span> </span><span id="local-6989586621679184765"><span class="annot"><a href="#local-6989586621679184765"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621679184764"><span class="annot"><a href="#local-6989586621679184764"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621679184763"><span class="annot"><a href="#local-6989586621679184763"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="HHT"><span class="annot"><a href="Numeric.HHT.html#HHT"><span class="hs-identifier hs-var">HHT</span></a></span></span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- | Skeleton lines corresponding to each IMF</span><span>
</span><span id="line-110"></span><span>      </span><span id="hhtLines"><span class="annot"><span class="annottext">HHT v n a -&gt; [HHTLine v n a]
</span><a href="Numeric.HHT.html#hhtLines"><span class="hs-identifier hs-var hs-var">hhtLines</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Numeric.HHT.html#HHTLine"><span class="hs-identifier hs-type">HHTLine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184765"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184764"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184763"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-111"></span><span>      </span><span class="hs-comment">-- | Residual from EMD</span><span>
</span><span id="line-112"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-113"></span><span>      </span><span class="hs-comment">-- @since 0.1.9.0</span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="hhtResidual"><span class="annot"><span class="annottext">HHT v n a -&gt; Vector v (n + 1) a
</span><a href="Numeric.HHT.html#hhtResidual"><span class="hs-identifier hs-var hs-var">hhtResidual</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184765"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679184764"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679184763"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679184458"><span id="local-6989586621679184460"><span id="local-6989586621679184462"><span class="annot"><span class="annottext">Int -&gt; HHT v n a -&gt; ShowS
[HHT v n a] -&gt; ShowS
HHT v n a -&gt; String
(Int -&gt; HHT v n a -&gt; ShowS)
-&gt; (HHT v n a -&gt; String)
-&gt; ([HHT v n a] -&gt; ShowS)
-&gt; Show (HHT v n a)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall (v :: * -&gt; *) (n :: Nat) a.
(Show a, Show (v a)) =&gt;
Int -&gt; HHT v n a -&gt; ShowS
forall (v :: * -&gt; *) (n :: Nat) a.
(Show a, Show (v a)) =&gt;
[HHT v n a] -&gt; ShowS
forall (v :: * -&gt; *) (n :: Nat) a.
(Show a, Show (v a)) =&gt;
HHT v n a -&gt; String
showList :: [HHT v n a] -&gt; ShowS
$cshowList :: forall (v :: * -&gt; *) (n :: Nat) a.
(Show a, Show (v a)) =&gt;
[HHT v n a] -&gt; ShowS
show :: HHT v n a -&gt; String
$cshow :: forall (v :: * -&gt; *) (n :: Nat) a.
(Show a, Show (v a)) =&gt;
HHT v n a -&gt; String
showsPrec :: Int -&gt; HHT v n a -&gt; ShowS
$cshowsPrec :: forall (v :: * -&gt; *) (n :: Nat) a.
(Show a, Show (v a)) =&gt;
Int -&gt; HHT v n a -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679184454"><span id="local-6989586621679184456"><span class="annot"><span class="annottext">HHT v n a -&gt; HHT v n a -&gt; Bool
(HHT v n a -&gt; HHT v n a -&gt; Bool)
-&gt; (HHT v n a -&gt; HHT v n a -&gt; Bool) -&gt; Eq (HHT v n a)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall (v :: * -&gt; *) (n :: Nat) a.
(Eq a, Eq (v a)) =&gt;
HHT v n a -&gt; HHT v n a -&gt; Bool
/= :: HHT v n a -&gt; HHT v n a -&gt; Bool
$c/= :: forall (v :: * -&gt; *) (n :: Nat) a.
(Eq a, Eq (v a)) =&gt;
HHT v n a -&gt; HHT v n a -&gt; Bool
== :: HHT v n a -&gt; HHT v n a -&gt; Bool
$c== :: forall (v :: * -&gt; *) (n :: Nat) a.
(Eq a, Eq (v a)) =&gt;
HHT v n a -&gt; HHT v n a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679184439"><span id="local-6989586621679184441"><span id="local-6989586621679184443"><span id="local-6989586621679184445"><span id="local-6989586621679184447"><span id="local-6989586621679184449"><span id="local-6989586621679184451"><span class="annot"><span class="annottext">Eq (HHT v n a)
Eq (HHT v n a) =&gt;
(HHT v n a -&gt; HHT v n a -&gt; Ordering)
-&gt; (HHT v n a -&gt; HHT v n a -&gt; Bool)
-&gt; (HHT v n a -&gt; HHT v n a -&gt; Bool)
-&gt; (HHT v n a -&gt; HHT v n a -&gt; Bool)
-&gt; (HHT v n a -&gt; HHT v n a -&gt; Bool)
-&gt; (HHT v n a -&gt; HHT v n a -&gt; HHT v n a)
-&gt; (HHT v n a -&gt; HHT v n a -&gt; HHT v n a)
-&gt; Ord (HHT v n a)
HHT v n a -&gt; HHT v n a -&gt; Bool
HHT v n a -&gt; HHT v n a -&gt; Ordering
HHT v n a -&gt; HHT v n a -&gt; HHT v n a
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall (v :: * -&gt; *) (n :: Nat) a.
(Ord a, Ord (v a)) =&gt;
Eq (HHT v n a)
forall (v :: * -&gt; *) (n :: Nat) a.
(Ord a, Ord (v a)) =&gt;
HHT v n a -&gt; HHT v n a -&gt; Bool
forall (v :: * -&gt; *) (n :: Nat) a.
(Ord a, Ord (v a)) =&gt;
HHT v n a -&gt; HHT v n a -&gt; Ordering
forall (v :: * -&gt; *) (n :: Nat) a.
(Ord a, Ord (v a)) =&gt;
HHT v n a -&gt; HHT v n a -&gt; HHT v n a
min :: HHT v n a -&gt; HHT v n a -&gt; HHT v n a
$cmin :: forall (v :: * -&gt; *) (n :: Nat) a.
(Ord a, Ord (v a)) =&gt;
HHT v n a -&gt; HHT v n a -&gt; HHT v n a
max :: HHT v n a -&gt; HHT v n a -&gt; HHT v n a
$cmax :: forall (v :: * -&gt; *) (n :: Nat) a.
(Ord a, Ord (v a)) =&gt;
HHT v n a -&gt; HHT v n a -&gt; HHT v n a
&gt;= :: HHT v n a -&gt; HHT v n a -&gt; Bool
$c&gt;= :: forall (v :: * -&gt; *) (n :: Nat) a.
(Ord a, Ord (v a)) =&gt;
HHT v n a -&gt; HHT v n a -&gt; Bool
&gt; :: HHT v n a -&gt; HHT v n a -&gt; Bool
$c&gt; :: forall (v :: * -&gt; *) (n :: Nat) a.
(Ord a, Ord (v a)) =&gt;
HHT v n a -&gt; HHT v n a -&gt; Bool
&lt;= :: HHT v n a -&gt; HHT v n a -&gt; Bool
$c&lt;= :: forall (v :: * -&gt; *) (n :: Nat) a.
(Ord a, Ord (v a)) =&gt;
HHT v n a -&gt; HHT v n a -&gt; Bool
&lt; :: HHT v n a -&gt; HHT v n a -&gt; Bool
$c&lt; :: forall (v :: * -&gt; *) (n :: Nat) a.
(Ord a, Ord (v a)) =&gt;
HHT v n a -&gt; HHT v n a -&gt; Bool
compare :: HHT v n a -&gt; HHT v n a -&gt; Ordering
$ccompare :: forall (v :: * -&gt; *) (n :: Nat) a.
(Ord a, Ord (v a)) =&gt;
HHT v n a -&gt; HHT v n a -&gt; Ordering
$cp1Ord :: forall (v :: * -&gt; *) (n :: Nat) a.
(Ord a, Ord (v a)) =&gt;
Eq (HHT v n a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. HHT v n a -&gt; Rep (HHT v n a) x)
-&gt; (forall x. Rep (HHT v n a) x -&gt; HHT v n a)
-&gt; Generic (HHT v n a)
forall x. Rep (HHT v n a) x -&gt; HHT v n a
forall x. HHT v n a -&gt; Rep (HHT v n a) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall (v :: * -&gt; *) (n :: Nat) a x. Rep (HHT v n a) x -&gt; HHT v n a
forall (v :: * -&gt; *) (n :: Nat) a x. HHT v n a -&gt; Rep (HHT v n a) x
$cto :: forall (v :: * -&gt; *) (n :: Nat) a x. Rep (HHT v n a) x -&gt; HHT v n a
$cfrom :: forall (v :: * -&gt; *) (n :: Nat) a x. HHT v n a -&gt; Rep (HHT v n a) x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="hs-comment">-- | @since 0.1.3.0</span><span>
</span><span id="line-119"></span><span id="local-6989586621679184434"><span id="local-6989586621679184435"><span id="local-6989586621679184436"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679184428"><span id="local-6989586621679184430"><span id="local-6989586621679184432"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184436"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184435"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679184434"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bi.Binary</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679184436"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184435"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bi.Binary</span></span><span> </span><span class="annot"><a href="#local-6989586621679184435"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bi.Binary</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.HHT.html#HHT"><span class="hs-identifier hs-type">HHT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184436"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184434"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184435"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="hs-comment">-- | @since 0.1.5.0</span><span>
</span><span id="line-122"></span><span id="local-6989586621679184425"><span id="local-6989586621679184426"><span id="local-6989586621679184427"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679184423"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679184427"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184426"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="#local-6989586621679184426"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.HHT.html#HHT"><span class="hs-identifier hs-type">HHT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184427"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184425"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184426"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span class="hs-comment">-- | Directly compute the Hilbert-Huang transform of a given time series.</span><span>
</span><span id="line-125"></span><span class="hs-comment">-- Essentially is a composition of 'hhtEmd' and 'emd'.  See 'hhtEmd' for</span><span>
</span><span id="line-126"></span><span class="hs-comment">-- a more flexible version.</span><span>
</span><span id="line-127"></span><span class="annot"><a href="Numeric.HHT.html#hht"><span class="hs-identifier hs-type">hht</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679184422"><span class="annot"><a href="#local-6989586621679184422"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621679184421"><span class="annot"><a href="#local-6989586621679184421"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621679184420"><span class="annot"><a href="#local-6989586621679184420"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184422"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184420"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184422"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Complex</span></span><span> </span><span class="annot"><a href="#local-6989586621679184420"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679184421"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FFT.FFTWReal</span></span><span> </span><span class="annot"><a href="#local-6989586621679184420"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.EMD.Internal.Sift.html#EMDOpts"><span class="hs-identifier hs-type">EMDOpts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184420"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184422"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679184421"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679184420"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.HHT.html#HHT"><span class="hs-identifier hs-type">HHT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184422"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184421"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184420"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-131"></span><span id="hht"><span class="annot"><span class="annottext">hht :: EMDOpts a -&gt; Vector v (n + 1) a -&gt; HHT v n a
</span><a href="Numeric.HHT.html#hht"><span class="hs-identifier hs-var hs-var">hht</span></a></span></span><span> </span><span id="local-6989586621679184419"><span class="annot"><span class="annottext">eo :: EMDOpts a
</span><a href="#local-6989586621679184419"><span class="hs-identifier hs-var">eo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EMD v (n + 1) a -&gt; HHT v n a
forall (v :: * -&gt; *) (n :: Nat) a.
(Vector v a, Vector v (Complex a), KnownNat n, FFTWReal a) =&gt;
EMD v (n + 1) a -&gt; HHT v n a
</span><a href="Numeric.HHT.html#hhtEmd"><span class="hs-identifier hs-var">hhtEmd</span></a></span><span> </span><span class="annot"><span class="annottext">(EMD v (n + 1) a -&gt; HHT v n a)
-&gt; (Vector v (n + 1) a -&gt; EMD v (n + 1) a)
-&gt; Vector v (n + 1) a
-&gt; HHT v n a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">EMDOpts a -&gt; Vector v (n + 1) a -&gt; EMD v (n + 1) a
forall (v :: * -&gt; *) a (n :: Nat).
(Vector v a, KnownNat n, Floating a, Ord a) =&gt;
EMDOpts a -&gt; Vector v (n + 1) a -&gt; EMD v (n + 1) a
</span><a href="Numeric.EMD.html#emd"><span class="hs-identifier hs-var">emd</span></a></span><span> </span><span class="annot"><span class="annottext">EMDOpts a
</span><a href="#local-6989586621679184419"><span class="hs-identifier hs-var">eo</span></a></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="hs-comment">-- | Compute the Hilbert-Huang transform from a given Empirical Mode</span><span>
</span><span id="line-134"></span><span class="hs-comment">-- Decomposition.</span><span>
</span><span id="line-135"></span><span class="annot"><a href="Numeric.HHT.html#hhtEmd"><span class="hs-identifier hs-type">hhtEmd</span></a></span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679184782"><span class="annot"><a href="#local-6989586621679184782"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621679184779"><span class="annot"><a href="#local-6989586621679184779"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621679184781"><span class="annot"><a href="#local-6989586621679184781"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184782"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184781"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184782"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Complex</span></span><span> </span><span class="annot"><a href="#local-6989586621679184781"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679184779"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FFT.FFTWReal</span></span><span> </span><span class="annot"><a href="#local-6989586621679184781"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.EMD.html#EMD"><span class="hs-identifier hs-type">EMD</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184782"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679184779"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679184781"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-138"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.HHT.html#HHT"><span class="hs-identifier hs-type">HHT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184782"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184779"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184781"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-139"></span><span id="hhtEmd"><span class="annot"><span class="annottext">hhtEmd :: EMD v (n + 1) a -&gt; HHT v n a
</span><a href="Numeric.HHT.html#hhtEmd"><span class="hs-identifier hs-var hs-var">hhtEmd</span></a></span></span><span> </span><span id="local-6989586621679184415"><span id="local-6989586621679184416"><span class="annot"><a href="Numeric.EMD.html#EMD"><span class="hs-identifier hs-type">EMD</span></a></span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[HHTLine v n a] -&gt; Vector v (n + 1) a -&gt; HHT v n a
forall (v :: * -&gt; *) (n :: Nat) a.
[HHTLine v n a] -&gt; Vector v (n + 1) a -&gt; HHT v n a
</span><a href="Numeric.HHT.html#HHT"><span class="hs-identifier hs-var">HHT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Vector v (n + 1) a -&gt; HHTLine v n a)
-&gt; [Vector v (n + 1) a] -&gt; [HHTLine v n a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Vector v (n + 1) a -&gt; HHTLine v n a
forall (v :: * -&gt; *) a (n :: Nat).
(Vector v a, Vector v (Complex a), KnownNat n, FFTWReal a) =&gt;
Vector v (n + 1) a -&gt; HHTLine v n a
</span><a href="#local-6989586621679184411"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Vector v (n + 1) a]
</span><a href="#local-6989586621679184416"><span class="hs-identifier hs-var">emdIMFs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector v (n + 1) a
</span><a href="#local-6989586621679184415"><span class="hs-identifier hs-var">emdResidual</span></a></span><span>
</span><span id="line-140"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-141"></span><span>    </span><span id="local-6989586621679184411"><span class="annot"><span class="annottext">go :: Vector v (n + 1) a -&gt; HHTLine v n a
</span><a href="#local-6989586621679184411"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679184410"><span class="annot"><span class="annottext">i :: Vector v (n + 1) a
</span><a href="#local-6989586621679184410"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector v (n + 1) a -&gt; Vector v n a -&gt; a -&gt; HHTLine v n a
forall (v :: * -&gt; *) (n :: Nat) a.
Vector v (n + 1) a -&gt; Vector v n a -&gt; a -&gt; HHTLine v n a
</span><a href="Numeric.HHT.html#HHTLine"><span class="hs-identifier hs-var">HHTLine</span></a></span><span> </span><span class="annot"><span class="annottext">Vector v (n + 1) a
</span><a href="#local-6989586621679184409"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Vector v n a
</span><a href="#local-6989586621679184408"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679184407"><span class="hs-identifier hs-var">&#966;0</span></a></span><span>
</span><span id="line-142"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-143"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679184409"><span class="annot"><span class="annottext">m :: Vector v (n + 1) a
</span><a href="#local-6989586621679184409"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679184408"><span class="annot"><span class="annottext">f :: Vector v n a
</span><a href="#local-6989586621679184408"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679184407"><span class="annot"><span class="annottext">&#966;0 :: a
</span><a href="#local-6989586621679184407"><span class="hs-identifier hs-var">&#966;0</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector v (n + 1) a -&gt; (Vector v (n + 1) a, (Vector v n a, a))
forall (v :: * -&gt; *) (n :: Nat) a.
(Vector v a, Vector v (Complex a), KnownNat n, FFTWReal a) =&gt;
Vector v (n + 1) a -&gt; (Vector v (n + 1) a, (Vector v n a, a))
</span><a href="Numeric.HHT.html#hilbertMagFreq"><span class="hs-identifier hs-var">hilbertMagFreq</span></a></span><span> </span><span class="annot"><span class="annottext">Vector v (n + 1) a
</span><a href="#local-6989586621679184410"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span class="hs-comment">-- | Invert a Hilbert-Huang transform back to an Empirical Mode</span><span>
</span><span id="line-146"></span><span class="hs-comment">-- Decomposition</span><span>
</span><span id="line-147"></span><span class="hs-comment">--</span><span>
</span><span id="line-148"></span><span class="hs-comment">-- @since 0.1.9.0</span><span>
</span><span id="line-149"></span><span id="local-6989586621679184722"><span id="local-6989586621679184723"><span id="local-6989586621679184724"><span class="annot"><a href="Numeric.HHT.html#ihhtEmd"><span class="hs-identifier hs-type">ihhtEmd</span></a></span><span>
</span><span id="line-150"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184724"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184723"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="annot"><a href="#local-6989586621679184723"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.HHT.html#HHT"><span class="hs-identifier hs-type">HHT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184724"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184722"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184723"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-152"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.EMD.html#EMD"><span class="hs-identifier hs-type">EMD</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184724"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679184722"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679184723"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-153"></span><span id="ihhtEmd"><span class="annot"><span class="annottext">ihhtEmd :: HHT v n a -&gt; EMD v (n + 1) a
</span><a href="Numeric.HHT.html#ihhtEmd"><span class="hs-identifier hs-var hs-var">ihhtEmd</span></a></span></span><span> </span><span id="local-6989586621679184405"><span id="local-6989586621679184406"><span class="annot"><a href="Numeric.HHT.html#HHT"><span class="hs-identifier hs-type">HHT</span></a></span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Vector v (n + 1) a] -&gt; Vector v (n + 1) a -&gt; EMD v (n + 1) a
forall (v :: * -&gt; *) (n :: Nat) a.
[Vector v n a] -&gt; Vector v n a -&gt; EMD v n a
</span><a href="Numeric.EMD.html#EMD"><span class="hs-identifier hs-var">EMD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(HHTLine v n a -&gt; Vector v (n + 1) a)
-&gt; [HHTLine v n a] -&gt; [Vector v (n + 1) a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">HHTLine v n a -&gt; Vector v (n + 1) a
forall (v :: * -&gt; *) c (n :: Nat).
(Vector v c, Floating c) =&gt;
HHTLine v n c -&gt; Vector v (1 + n) c
</span><a href="#local-6989586621679184404"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[HHTLine v n a]
</span><a href="#local-6989586621679184406"><span class="hs-identifier hs-var">hhtLines</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector v (n + 1) a
</span><a href="#local-6989586621679184405"><span class="hs-identifier hs-var">hhtResidual</span></a></span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-155"></span><span>    </span><span id="local-6989586621679184404"><span class="annot"><span class="annottext">go :: HHTLine v n c -&gt; Vector v (1 + n) c
</span><a href="#local-6989586621679184404"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679184401"><span id="local-6989586621679184402"><span id="local-6989586621679184403"><span class="annot"><a href="Numeric.HHT.html#HHTLine"><span class="hs-identifier hs-type">HHTLine</span></a></span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(c -&gt; c -&gt; c)
-&gt; Vector v (1 + n) c -&gt; Vector v (1 + n) c -&gt; Vector v (1 + n) c
forall (v :: * -&gt; *) a b c (n :: Nat).
(Vector v a, Vector v b, Vector v c) =&gt;
(a -&gt; b -&gt; c) -&gt; Vector v n a -&gt; Vector v n b -&gt; Vector v n c
</span><span class="hs-identifier hs-var">SVG.zipWith</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679184399"><span class="annot"><span class="annottext">m :: c
</span><a href="#local-6989586621679184399"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679184398"><span class="annot"><span class="annottext">&#952; :: c
</span><a href="#local-6989586621679184398"><span class="hs-identifier hs-var">&#952;</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679184399"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">c -&gt; c -&gt; c
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">c -&gt; c
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679184398"><span class="hs-identifier hs-var">&#952;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector v (n + 1) c
Vector v (1 + n) c
</span><a href="#local-6989586621679184403"><span class="hs-identifier hs-var">hlMags</span></a></span><span> </span><span class="annot"><span class="annottext">Vector v (1 + n) c
</span><a href="#local-6989586621679184395"><span class="hs-identifier hs-var">&#952;s</span></a></span><span>
</span><span id="line-156"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-157"></span><span>        </span><span id="local-6989586621679184395"><span class="annot"><span class="annottext">&#952;s :: Vector v (1 + n) c
</span><a href="#local-6989586621679184395"><span class="hs-identifier hs-var hs-var">&#952;s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(c -&gt; c -&gt; c) -&gt; c -&gt; Vector v n c -&gt; Vector v (1 + n) c
forall (v :: * -&gt; *) a b (n :: Nat).
(Vector v a, Vector v b) =&gt;
(a -&gt; b -&gt; a) -&gt; a -&gt; Vector v n b -&gt; Vector v (1 + n) a
</span><span class="hs-identifier hs-var">SVG.scanl'</span></span><span> </span><span class="annot"><span class="annottext">c -&gt; c -&gt; c
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679184401"><span class="hs-identifier hs-var">hlInitPhase</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">c -&gt; c -&gt; c
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">c -&gt; c -&gt; c
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">c
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(c -&gt; c) -&gt; Vector v n c -&gt; Vector v n c
forall (v :: * -&gt; *) a b (n :: Nat).
(Vector v a, Vector v b) =&gt;
(a -&gt; b) -&gt; Vector v n a -&gt; Vector v n b
</span><span class="hs-operator hs-var">`SVG.map`</span></span><span> </span><span class="annot"><span class="annottext">Vector v n c
</span><a href="#local-6989586621679184402"><span class="hs-identifier hs-var">hlFreqs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span class="hs-comment">-- | Construct a time series correpsonding to its hilbert-huang transform.</span><span>
</span><span id="line-160"></span><span class="hs-comment">--</span><span>
</span><span id="line-161"></span><span class="hs-comment">-- @since 0.1.9.0</span><span>
</span><span id="line-162"></span><span id="local-6989586621679184388"><span id="local-6989586621679184389"><span id="local-6989586621679184390"><span class="annot"><a href="Numeric.HHT.html#ihht"><span class="hs-identifier hs-type">ihht</span></a></span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184390"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184389"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="annot"><a href="#local-6989586621679184389"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.HHT.html#HHT"><span class="hs-identifier hs-type">HHT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184390"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184388"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184389"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-165"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184390"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679184388"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679184389"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-166"></span><span id="ihht"><span class="annot"><span class="annottext">ihht :: HHT v n a -&gt; Vector v (n + 1) a
</span><a href="Numeric.HHT.html#ihht"><span class="hs-identifier hs-var hs-var">ihht</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EMD v (n + 1) a -&gt; Vector v (n + 1) a
forall (v :: * -&gt; *) a (n :: Nat).
(Vector v a, Num a) =&gt;
EMD v n a -&gt; Vector v n a
</span><a href="Numeric.EMD.html#iemd"><span class="hs-identifier hs-var">iemd</span></a></span><span> </span><span class="annot"><span class="annottext">(EMD v (n + 1) a -&gt; Vector v (n + 1) a)
-&gt; (HHT v n a -&gt; EMD v (n + 1) a)
-&gt; HHT v n a
-&gt; Vector v (n + 1) a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HHT v n a -&gt; EMD v (n + 1) a
forall (v :: * -&gt; *) a (n :: Nat).
(Vector v a, Floating a) =&gt;
HHT v n a -&gt; EMD v (n + 1) a
</span><a href="Numeric.HHT.html#ihhtEmd"><span class="hs-identifier hs-var">ihhtEmd</span></a></span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span class="hs-comment">-- | Fold and collapse a Hilbert-Huang transform along the frequency axis</span><span>
</span><span id="line-169"></span><span class="hs-comment">-- at each step in time along some monoid.</span><span>
</span><span id="line-170"></span><span class="hs-comment">--</span><span>
</span><span id="line-171"></span><span class="hs-comment">-- @since 0.1.8.0</span><span>
</span><span id="line-172"></span><span class="annot"><a href="Numeric.HHT.html#foldFreq"><span class="hs-identifier hs-type">foldFreq</span></a></span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679184669"><span class="annot"><a href="#local-6989586621679184669"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621679184667"><span class="annot"><a href="#local-6989586621679184667"><span class="hs-identifier hs-type">u</span></a></span></span><span> </span><span id="local-6989586621679184665"><span class="annot"><a href="#local-6989586621679184665"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621679184668"><span class="annot"><a href="#local-6989586621679184668"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679184664"><span class="annot"><a href="#local-6989586621679184664"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621679184666"><span class="annot"><a href="#local-6989586621679184666"><span class="hs-identifier hs-type">c</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184669"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184668"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184667"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184666"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679184665"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679184664"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679184668"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679184668"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679184664"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- ^ Combining function, taking frequency, then magnitude</span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679184664"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679184666"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>       </span><span class="hs-comment">-- ^ Projecting function</span><span>
</span><span id="line-176"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.HHT.html#HHT"><span class="hs-identifier hs-type">HHT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184669"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184665"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184668"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184667"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184665"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184666"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-178"></span><span id="foldFreq"><span class="annot"><span class="annottext">foldFreq :: (a -&gt; a -&gt; b) -&gt; (b -&gt; c) -&gt; HHT v n a -&gt; Vector u n c
</span><a href="Numeric.HHT.html#foldFreq"><span class="hs-identifier hs-var hs-var">foldFreq</span></a></span></span><span> </span><span id="local-6989586621679184386"><span class="annot"><span class="annottext">f :: a -&gt; a -&gt; b
</span><a href="#local-6989586621679184386"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679184385"><span class="annot"><span class="annottext">g :: b -&gt; c
</span><a href="#local-6989586621679184385"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector n b -&gt; Vector u n c
</span><a href="#local-6989586621679184384"><span class="hs-identifier hs-var">pullBack</span></a></span><span>
</span><span id="line-179"></span><span>             </span><span class="annot"><span class="annottext">(Vector n b -&gt; Vector u n c)
-&gt; (HHT v n a -&gt; Vector n b) -&gt; HHT v n a -&gt; Vector u n c
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Vector n b -&gt; Vector n b -&gt; Vector n b)
-&gt; Vector n b -&gt; [Vector n b] -&gt; Vector n b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(b -&gt; b -&gt; b) -&gt; Vector n b -&gt; Vector n b -&gt; Vector n b
forall a b c (n :: Nat).
(a -&gt; b -&gt; c) -&gt; Vector n a -&gt; Vector n b -&gt; Vector n c
</span><span class="hs-identifier hs-var">SV.zipWith</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; Vector n b
forall (n :: Nat) a. KnownNat n =&gt; a -&gt; Vector n a
</span><span class="hs-identifier hs-var">SV.replicate</span></span><span> </span><span class="annot"><span class="annottext">b
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>             </span><span class="annot"><span class="annottext">([Vector n b] -&gt; Vector n b)
-&gt; (HHT v n a -&gt; [Vector n b]) -&gt; HHT v n a -&gt; Vector n b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(HHTLine v n a -&gt; Vector n b) -&gt; [HHTLine v n a] -&gt; [Vector n b]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">HHTLine v n a -&gt; Vector n b
</span><a href="#local-6989586621679184380"><span class="hs-identifier hs-var">split</span></a></span><span>
</span><span id="line-181"></span><span>             </span><span class="annot"><span class="annottext">([HHTLine v n a] -&gt; [Vector n b])
-&gt; (HHT v n a -&gt; [HHTLine v n a]) -&gt; HHT v n a -&gt; [Vector n b]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HHT v n a -&gt; [HHTLine v n a]
forall (v :: * -&gt; *) (n :: Nat) a. HHT v n a -&gt; [HHTLine v n a]
</span><a href="Numeric.HHT.html#hhtLines"><span class="hs-identifier hs-var hs-var">hhtLines</span></a></span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-183"></span><span>    </span><span class="annot"><a href="#local-6989586621679184380"><span class="hs-identifier hs-type">split</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Numeric.HHT.html#HHTLine"><span class="hs-identifier hs-type">HHTLine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184669"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184665"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184668"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SV.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184665"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184664"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-184"></span><span>    </span><span id="local-6989586621679184380"><span class="annot"><span class="annottext">split :: HHTLine v n a -&gt; Vector n b
</span><a href="#local-6989586621679184380"><span class="hs-identifier hs-var hs-var">split</span></a></span></span><span> </span><span id="local-6989586621679184377"><span id="local-6989586621679184378"><span id="local-6989586621679184379"><span class="annot"><a href="Numeric.HHT.html#HHTLine"><span class="hs-identifier hs-type">HHTLine</span></a></span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Finite n -&gt; b) -&gt; Vector n b
forall (v :: * -&gt; *) (n :: Nat) a.
(KnownNat n, Vector v a) =&gt;
(Finite n -&gt; a) -&gt; Vector v n a
</span><span class="hs-identifier hs-var">SVG.generate</span></span><span> </span><span class="annot"><span class="annottext">((Finite n -&gt; b) -&gt; Vector n b) -&gt; (Finite n -&gt; b) -&gt; Vector n b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679184375"><span class="annot"><span class="annottext">i :: Finite n
</span><a href="#local-6989586621679184375"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-185"></span><span>      </span><span class="annot"><span class="annottext">a -&gt; a -&gt; b
</span><a href="#local-6989586621679184386"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector v n a
</span><a href="#local-6989586621679184378"><span class="hs-identifier hs-var">hlFreqs</span></a></span><span> </span><span class="annot"><span class="annottext">Vector v n a -&gt; Finite n -&gt; a
forall (v :: * -&gt; *) (n :: Nat) a.
Vector v a =&gt;
Vector v n a -&gt; Finite n -&gt; a
</span><span class="hs-operator hs-var">`SVG.index`</span></span><span> </span><span class="annot"><span class="annottext">Finite n
</span><a href="#local-6989586621679184375"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector v (n + 1) a
</span><a href="#local-6989586621679184379"><span class="hs-identifier hs-var">hlMags</span></a></span><span> </span><span class="annot"><span class="annottext">Vector v (n + 1) a -&gt; Finite (n + 1) -&gt; a
forall (v :: * -&gt; *) (n :: Nat) a.
Vector v a =&gt;
Vector v n a -&gt; Finite n -&gt; a
</span><span class="hs-operator hs-var">`SVG.index`</span></span><span> </span><span class="annot"><span class="annottext">Finite n -&gt; Finite (n + 1)
forall (n :: Nat). Finite n -&gt; Finite (n + 1)
</span><span class="hs-identifier hs-var">weaken</span></span><span> </span><span class="annot"><span class="annottext">Finite n
</span><a href="#local-6989586621679184375"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="#local-6989586621679184380"><span class="hs-pragma hs-type">split</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-187"></span><span>    </span><span class="annot"><a href="#local-6989586621679184384"><span class="hs-identifier hs-type">pullBack</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SV.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184665"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184664"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184667"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184665"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184666"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-188"></span><span>    </span><span id="local-6989586621679184384"><span class="annot"><span class="annottext">pullBack :: Vector n b -&gt; Vector u n c
</span><a href="#local-6989586621679184384"><span class="hs-identifier hs-var hs-var">pullBack</span></a></span></span><span> </span><span id="local-6989586621679184372"><span class="annot"><span class="annottext">v :: Vector n b
</span><a href="#local-6989586621679184372"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Finite n -&gt; c) -&gt; Vector u n c
forall (v :: * -&gt; *) (n :: Nat) a.
(KnownNat n, Vector v a) =&gt;
(Finite n -&gt; a) -&gt; Vector v n a
</span><span class="hs-identifier hs-var">SVG.generate</span></span><span> </span><span class="annot"><span class="annottext">((Finite n -&gt; c) -&gt; Vector u n c)
-&gt; (Finite n -&gt; c) -&gt; Vector u n c
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679184371"><span class="annot"><span class="annottext">i :: Finite n
</span><a href="#local-6989586621679184371"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">b -&gt; c
</span><a href="#local-6989586621679184385"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector n b
</span><a href="#local-6989586621679184372"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Vector n b -&gt; Finite n -&gt; b
forall (n :: Nat) a. Vector n a -&gt; Finite n -&gt; a
</span><span class="hs-operator hs-var">`SV.index`</span></span><span> </span><span class="annot"><span class="annottext">Finite n
</span><a href="#local-6989586621679184371"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="#local-6989586621679184384"><span class="hs-pragma hs-type">pullBack</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-190"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Numeric.HHT.html#foldFreq"><span class="hs-pragma hs-type">foldFreq</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="hs-keyword">newtype</span><span> </span><span id="SumMap"><span class="annot"><a href="Numeric.HHT.html#SumMap"><span class="hs-identifier hs-var">SumMap</span></a></span></span><span> </span><span id="local-6989586621679184681"><span class="annot"><a href="#local-6989586621679184681"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679184680"><span class="annot"><a href="#local-6989586621679184680"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SumMap"><span class="annot"><a href="Numeric.HHT.html#SumMap"><span class="hs-identifier hs-var">SumMap</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="getSumMap"><span class="annot"><span class="annottext">SumMap k a -&gt; Map k a
</span><a href="Numeric.HHT.html#getSumMap"><span class="hs-identifier hs-var hs-var">getSumMap</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679184681"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184680"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span id="local-6989586621679184366"><span id="local-6989586621679184367"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679184361"><span id="local-6989586621679184363"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679184367"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679184366"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.HHT.html#SumMap"><span class="hs-identifier hs-type">SumMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184367"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184366"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-195"></span><span>    </span><span class="annot"><a href="Numeric.HHT.html#SumMap"><span class="hs-identifier hs-type">SumMap</span></a></span><span> </span><span id="local-6989586621679184359"><span class="annot"><span class="annottext">x :: Map k a
</span><a href="#local-6989586621679184359"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679184358"><span class="annot"><span class="annottext">&lt;&gt; :: SumMap k a -&gt; SumMap k a -&gt; SumMap k a
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="annot"><a href="Numeric.HHT.html#SumMap"><span class="hs-identifier hs-type">SumMap</span></a></span><span> </span><span id="local-6989586621679184357"><span class="annot"><span class="annottext">y :: Map k a
</span><a href="#local-6989586621679184357"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k a -&gt; SumMap k a
forall k a. Map k a -&gt; SumMap k a
</span><a href="Numeric.HHT.html#SumMap"><span class="hs-identifier hs-var">SumMap</span></a></span><span> </span><span class="annot"><span class="annottext">(Map k a -&gt; SumMap k a) -&gt; Map k a -&gt; SumMap k a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; Map k a -&gt; Map k a -&gt; Map k a
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.unionWith</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679184359"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679184357"><span class="hs-identifier hs-var">y</span></a></span></span></span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span id="local-6989586621679184354"><span id="local-6989586621679184355"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679184348"><span id="local-6989586621679184350"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679184355"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679184354"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.HHT.html#SumMap"><span class="hs-identifier hs-type">SumMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184355"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184354"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-198"></span><span>    </span><span id="local-6989586621679184346"><span class="annot"><span class="annottext">mempty :: SumMap k a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k a -&gt; SumMap k a
forall k a. Map k a -&gt; SumMap k a
</span><a href="Numeric.HHT.html#SumMap"><span class="hs-identifier hs-var">SumMap</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
forall k a. Map k a
</span><span class="hs-identifier hs-var">M.empty</span></span></span></span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span class="hs-comment">-- | Compute the full Hilbert-Huang Transform spectrum.  At each timestep</span><span>
</span><span id="line-201"></span><span class="hs-comment">-- is a sparse map of frequency components and their respective magnitudes.</span><span>
</span><span id="line-202"></span><span class="hs-comment">-- Frequencies not in the map are considered to be zero.</span><span>
</span><span id="line-203"></span><span class="hs-comment">--</span><span>
</span><span id="line-204"></span><span class="hs-comment">-- Takes a &quot;binning&quot; function to allow you to specify how specific you want</span><span>
</span><span id="line-205"></span><span class="hs-comment">-- your frequencies to be.</span><span>
</span><span id="line-206"></span><span class="hs-comment">--</span><span>
</span><span id="line-207"></span><span class="hs-comment">-- See 'hhtSparseSpetrum' for a sparser version, and 'hhtDenseSpectrum' for</span><span>
</span><span id="line-208"></span><span class="hs-comment">-- a denser version.</span><span>
</span><span id="line-209"></span><span class="annot"><a href="Numeric.HHT.html#hhtSpectrum"><span class="hs-identifier hs-type">hhtSpectrum</span></a></span><span>
</span><span id="line-210"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679184344"><span class="annot"><a href="#local-6989586621679184344"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621679184343"><span class="annot"><a href="#local-6989586621679184343"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621679184342"><span class="annot"><a href="#local-6989586621679184342"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679184341"><span class="annot"><a href="#local-6989586621679184341"><span class="hs-identifier hs-type">k</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184344"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184342"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679184343"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679184341"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679184342"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679184342"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679184341"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span>     </span><span class="hs-comment">-- ^ binning function.  takes rev/tick freq between 0 and 1.</span><span>
</span><span id="line-212"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.HHT.html#HHT"><span class="hs-identifier hs-type">HHT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184344"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184343"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184342"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-213"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SV.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184343"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679184341"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184342"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span id="hhtSpectrum"><span class="annot"><span class="annottext">hhtSpectrum :: (a -&gt; k) -&gt; HHT v n a -&gt; Vector n (Map k a)
</span><a href="Numeric.HHT.html#hhtSpectrum"><span class="hs-identifier hs-var hs-var">hhtSpectrum</span></a></span></span><span> </span><span id="local-6989586621679184340"><span class="annot"><span class="annottext">f :: a -&gt; k
</span><a href="#local-6989586621679184340"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; SumMap k a)
-&gt; (SumMap k a -&gt; Map k a) -&gt; HHT v n a -&gt; Vector n (Map k a)
forall (v :: * -&gt; *) (u :: * -&gt; *) (n :: Nat) a b c.
(Vector v a, Vector u c, KnownNat n, Monoid b) =&gt;
(a -&gt; a -&gt; b) -&gt; (b -&gt; c) -&gt; HHT v n a -&gt; Vector u n c
</span><a href="Numeric.HHT.html#foldFreq"><span class="hs-identifier hs-var">foldFreq</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679184339"><span class="annot"><span class="annottext">k :: a
</span><a href="#local-6989586621679184339"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map k a -&gt; SumMap k a
forall k a. Map k a -&gt; SumMap k a
</span><a href="Numeric.HHT.html#SumMap"><span class="hs-identifier hs-var">SumMap</span></a></span><span> </span><span class="annot"><span class="annottext">(Map k a -&gt; SumMap k a) -&gt; (a -&gt; Map k a) -&gt; a -&gt; SumMap k a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">k -&gt; a -&gt; Map k a
forall k a. k -&gt; a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.singleton</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; k
</span><a href="#local-6989586621679184340"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679184339"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SumMap k a -&gt; Map k a
forall k a. SumMap k a -&gt; Map k a
</span><a href="Numeric.HHT.html#getSumMap"><span class="hs-identifier hs-var hs-var">getSumMap</span></a></span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="hs-comment">-- | A sparser vesion of 'hhtSpectrum'.  Compute the full Hilbert-Huang</span><span>
</span><span id="line-217"></span><span class="hs-comment">-- Transform spectrum.  Returns a /sparse/ matrix representing the power at</span><span>
</span><span id="line-218"></span><span class="hs-comment">-- each time step (the @'Finite' n@) and frequency (the @k@).</span><span>
</span><span id="line-219"></span><span class="hs-comment">--</span><span>
</span><span id="line-220"></span><span class="hs-comment">-- Takes a &quot;binning&quot; function to allow you to specify how specific you want</span><span>
</span><span id="line-221"></span><span class="hs-comment">-- your frequencies to be.</span><span>
</span><span id="line-222"></span><span class="hs-comment">--</span><span>
</span><span id="line-223"></span><span class="hs-comment">-- @since 0.1.4.0</span><span>
</span><span id="line-224"></span><span class="annot"><a href="Numeric.HHT.html#hhtSparseSpectrum"><span class="hs-identifier hs-type">hhtSparseSpectrum</span></a></span><span>
</span><span id="line-225"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679184636"><span class="annot"><a href="#local-6989586621679184636"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621679184634"><span class="annot"><a href="#local-6989586621679184634"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621679184635"><span class="annot"><a href="#local-6989586621679184635"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679184633"><span class="annot"><a href="#local-6989586621679184633"><span class="hs-identifier hs-type">k</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184636"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184635"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679184634"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679184633"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679184635"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679184635"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679184633"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span>     </span><span class="hs-comment">-- ^ binning function.  takes rev/tick freq between 0 and 1.</span><span>
</span><span id="line-227"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.HHT.html#HHT"><span class="hs-identifier hs-type">HHT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184636"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184634"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184635"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-228"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Finite</span></span><span> </span><span class="annot"><a href="#local-6989586621679184634"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679184633"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679184635"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-229"></span><span id="hhtSparseSpectrum"><span class="annot"><span class="annottext">hhtSparseSpectrum :: (a -&gt; k) -&gt; HHT v n a -&gt; Map (Finite n, k) a
</span><a href="Numeric.HHT.html#hhtSparseSpectrum"><span class="hs-identifier hs-var hs-var">hhtSparseSpectrum</span></a></span></span><span> </span><span id="local-6989586621679184337"><span class="annot"><span class="annottext">f :: a -&gt; k
</span><a href="#local-6989586621679184337"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; [Map (Finite n, k) a] -&gt; Map (Finite n, k) a
forall (f :: * -&gt; *) k a.
(Foldable f, Ord k) =&gt;
(a -&gt; a -&gt; a) -&gt; f (Map k a) -&gt; Map k a
</span><span class="hs-identifier hs-var">M.unionsWith</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span> </span><span class="annot"><span class="annottext">([Map (Finite n, k) a] -&gt; Map (Finite n, k) a)
-&gt; (HHT v n a -&gt; [Map (Finite n, k) a])
-&gt; HHT v n a
-&gt; Map (Finite n, k) a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(HHTLine v n a -&gt; [Map (Finite n, k) a])
-&gt; [HHTLine v n a] -&gt; [Map (Finite n, k) a]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">HHTLine v n a -&gt; [Map (Finite n, k) a]
</span><a href="#local-6989586621679184334"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">([HHTLine v n a] -&gt; [Map (Finite n, k) a])
-&gt; (HHT v n a -&gt; [HHTLine v n a])
-&gt; HHT v n a
-&gt; [Map (Finite n, k) a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HHT v n a -&gt; [HHTLine v n a]
forall (v :: * -&gt; *) (n :: Nat) a. HHT v n a -&gt; [HHTLine v n a]
</span><a href="Numeric.HHT.html#hhtLines"><span class="hs-identifier hs-var hs-var">hhtLines</span></a></span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-231"></span><span>    </span><span class="annot"><a href="#local-6989586621679184334"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Numeric.HHT.html#HHTLine"><span class="hs-identifier hs-type">HHTLine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184636"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184634"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184635"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Finite</span></span><span> </span><span class="annot"><a href="#local-6989586621679184634"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679184633"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679184635"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-232"></span><span>    </span><span id="local-6989586621679184334"><span class="annot"><span class="annottext">go :: HHTLine v n a -&gt; [Map (Finite n, k) a]
</span><a href="#local-6989586621679184334"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679184331"><span id="local-6989586621679184332"><span id="local-6989586621679184333"><span class="annot"><a href="Numeric.HHT.html#HHTLine"><span class="hs-identifier hs-type">HHTLine</span></a></span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Finite n -&gt; Map (Finite n, k) a)
 -&gt; [Finite n] -&gt; [Map (Finite n, k) a])
-&gt; [Finite n]
-&gt; (Finite n -&gt; Map (Finite n, k) a)
-&gt; [Map (Finite n, k) a]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">(Finite n -&gt; Map (Finite n, k) a)
-&gt; [Finite n] -&gt; [Map (Finite n, k) a]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KnownNat n =&gt; [Finite n]
forall (n :: Nat). KnownNat n =&gt; [Finite n]
</span><span class="hs-identifier hs-var">finites</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679184634"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Finite n -&gt; Map (Finite n, k) a) -&gt; [Map (Finite n, k) a])
-&gt; (Finite n -&gt; Map (Finite n, k) a) -&gt; [Map (Finite n, k) a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679184328"><span class="annot"><span class="annottext">i :: Finite n
</span><a href="#local-6989586621679184328"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-233"></span><span>      </span><span class="annot"><span class="annottext">(Finite n, k) -&gt; a -&gt; Map (Finite n, k) a
forall k a. k -&gt; a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.singleton</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Finite n
</span><a href="#local-6989586621679184328"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; k
</span><a href="#local-6989586621679184337"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; k) -&gt; a -&gt; k
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector v n a
</span><a href="#local-6989586621679184332"><span class="hs-identifier hs-var">hlFreqs</span></a></span><span> </span><span class="annot"><span class="annottext">Vector v n a -&gt; Finite n -&gt; a
forall (v :: * -&gt; *) (n :: Nat) a.
Vector v a =&gt;
Vector v n a -&gt; Finite n -&gt; a
</span><span class="hs-operator hs-var">`SVG.index`</span></span><span> </span><span class="annot"><span class="annottext">Finite n
</span><a href="#local-6989586621679184328"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Map (Finite n, k) a) -&gt; a -&gt; Map (Finite n, k) a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-234"></span><span>        </span><span class="annot"><span class="annottext">Vector v (n + 1) a
</span><a href="#local-6989586621679184333"><span class="hs-identifier hs-var">hlMags</span></a></span><span> </span><span class="annot"><span class="annottext">Vector v (n + 1) a -&gt; Finite (n + 1) -&gt; a
forall (v :: * -&gt; *) (n :: Nat) a.
Vector v a =&gt;
Vector v n a -&gt; Finite n -&gt; a
</span><span class="hs-operator hs-var">`SVG.index`</span></span><span> </span><span class="annot"><span class="annottext">Finite n -&gt; Finite (n + 1)
forall (n :: Nat). Finite n -&gt; Finite (n + 1)
</span><span class="hs-identifier hs-var">weaken</span></span><span> </span><span class="annot"><span class="annottext">Finite n
</span><a href="#local-6989586621679184328"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span class="hs-comment">-- | A denser version of 'hhtSpectrum'.  Compute the full  Hilbert-Huang</span><span>
</span><span id="line-237"></span><span class="hs-comment">-- Transform spectrum, returning a dense matrix (as a vector of vectors)</span><span>
</span><span id="line-238"></span><span class="hs-comment">-- representing the power at each time step and each frequency.</span><span>
</span><span id="line-239"></span><span class="hs-comment">--</span><span>
</span><span id="line-240"></span><span class="hs-comment">-- Takes a &quot;binning&quot; function that maps a frequency to one of @m@ discrete</span><span>
</span><span id="line-241"></span><span class="hs-comment">-- slots, for accumulation in the dense matrix.</span><span>
</span><span id="line-242"></span><span class="hs-comment">--</span><span>
</span><span id="line-243"></span><span class="hs-comment">-- @since 0.1.4.0</span><span>
</span><span id="line-244"></span><span class="annot"><a href="Numeric.HHT.html#hhtDenseSpectrum"><span class="hs-identifier hs-type">hhtDenseSpectrum</span></a></span><span>
</span><span id="line-245"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679184327"><span class="annot"><a href="#local-6989586621679184327"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621679184326"><span class="annot"><a href="#local-6989586621679184326"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621679184325"><span class="annot"><a href="#local-6989586621679184325"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679184324"><span class="annot"><a href="#local-6989586621679184324"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184327"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184324"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679184326"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679184325"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679184324"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679184324"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Finite</span></span><span> </span><span class="annot"><a href="#local-6989586621679184325"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>     </span><span class="hs-comment">-- ^ binning function.  takes rev/tick freq between 0 and 1.</span><span>
</span><span id="line-247"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.HHT.html#HHT"><span class="hs-identifier hs-type">HHT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184327"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184326"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184324"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-248"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SV.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184326"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SV.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184325"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184324"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span id="hhtDenseSpectrum"><span class="annot"><span class="annottext">hhtDenseSpectrum :: (a -&gt; Finite m) -&gt; HHT v n a -&gt; Vector n (Vector m a)
</span><a href="Numeric.HHT.html#hhtDenseSpectrum"><span class="hs-identifier hs-var hs-var">hhtDenseSpectrum</span></a></span></span><span> </span><span id="local-6989586621679184323"><span class="annot"><span class="annottext">f :: a -&gt; Finite m
</span><a href="#local-6989586621679184323"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679184322"><span class="annot"><span class="annottext">h :: HHT v n a
</span><a href="#local-6989586621679184322"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Finite n -&gt; Vector m a) -&gt; Vector n (Vector m a)
forall (n :: Nat) a. KnownNat n =&gt; (Finite n -&gt; a) -&gt; Vector n a
</span><span class="hs-identifier hs-var">SV.generate</span></span><span> </span><span class="annot"><span class="annottext">((Finite n -&gt; Vector m a) -&gt; Vector n (Vector m a))
-&gt; (Finite n -&gt; Vector m a) -&gt; Vector n (Vector m a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679184320"><span class="annot"><span class="annottext">i :: Finite n
</span><a href="#local-6989586621679184320"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Finite m -&gt; a) -&gt; Vector m a
forall (n :: Nat) a. KnownNat n =&gt; (Finite n -&gt; a) -&gt; Vector n a
</span><span class="hs-identifier hs-var">SV.generate</span></span><span> </span><span class="annot"><span class="annottext">((Finite m -&gt; a) -&gt; Vector m a) -&gt; (Finite m -&gt; a) -&gt; Vector m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679184319"><span class="annot"><span class="annottext">j :: Finite m
</span><a href="#local-6989586621679184319"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-250"></span><span>    </span><span class="annot"><span class="annottext">a -&gt; (Finite n, Finite m) -&gt; Map (Finite n, Finite m) a -&gt; a
forall k a. Ord k =&gt; a -&gt; k -&gt; Map k a -&gt; a
</span><span class="hs-identifier hs-var">M.findWithDefault</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Finite n
</span><a href="#local-6989586621679184320"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Finite m
</span><a href="#local-6989586621679184319"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (Finite n, Finite m) a
</span><a href="#local-6989586621679184317"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-252"></span><span>    </span><span id="local-6989586621679184317"><span class="annot"><span class="annottext">ss :: Map (Finite n, Finite m) a
</span><a href="#local-6989586621679184317"><span class="hs-identifier hs-var hs-var">ss</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Finite m) -&gt; HHT v n a -&gt; Map (Finite n, Finite m) a
forall (v :: * -&gt; *) (n :: Nat) a k.
(Vector v a, KnownNat n, Ord k, Num a) =&gt;
(a -&gt; k) -&gt; HHT v n a -&gt; Map (Finite n, k) a
</span><a href="Numeric.HHT.html#hhtSparseSpectrum"><span class="hs-identifier hs-var">hhtSparseSpectrum</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Finite m
</span><a href="#local-6989586621679184323"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">HHT v n a
</span><a href="#local-6989586621679184322"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="hs-comment">-- | Compute the marginal spectrum given a Hilbert-Huang Transform. It</span><span>
</span><span id="line-255"></span><span class="hs-comment">-- provides the &quot;total power&quot; over the entire time series for each</span><span>
</span><span id="line-256"></span><span class="hs-comment">-- frequency component.  See 'meanMarginal' for a version that averages</span><span>
</span><span id="line-257"></span><span class="hs-comment">-- over the length of the time series, making it more close in nature to</span><span>
</span><span id="line-258"></span><span class="hs-comment">-- the purpose of a Fourier Transform.</span><span>
</span><span id="line-259"></span><span class="hs-comment">--</span><span>
</span><span id="line-260"></span><span class="hs-comment">-- A binning function is accepted to allow you to specify how specific you</span><span>
</span><span id="line-261"></span><span class="hs-comment">-- want your frequencies to be.</span><span>
</span><span id="line-262"></span><span class="annot"><a href="Numeric.HHT.html#marginal"><span class="hs-identifier hs-type">marginal</span></a></span><span>
</span><span id="line-263"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679184623"><span class="annot"><a href="#local-6989586621679184623"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621679184621"><span class="annot"><a href="#local-6989586621679184621"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621679184622"><span class="annot"><a href="#local-6989586621679184622"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679184620"><span class="annot"><a href="#local-6989586621679184620"><span class="hs-identifier hs-type">k</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184623"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184622"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679184621"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679184620"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679184622"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679184622"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679184620"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span>     </span><span class="hs-comment">-- ^ binning function.  takes rev/tick freq between 0 and 1.</span><span>
</span><span id="line-265"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.HHT.html#HHT"><span class="hs-identifier hs-type">HHT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184623"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184621"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184622"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-266"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679184620"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184622"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-267"></span><span id="marginal"><span class="annot"><span class="annottext">marginal :: (a -&gt; k) -&gt; HHT v n a -&gt; Map k a
</span><a href="Numeric.HHT.html#marginal"><span class="hs-identifier hs-var hs-var">marginal</span></a></span></span><span> </span><span id="local-6989586621679184316"><span class="annot"><span class="annottext">f :: a -&gt; k
</span><a href="#local-6989586621679184316"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; [Map k a] -&gt; Map k a
forall (f :: * -&gt; *) k a.
(Foldable f, Ord k) =&gt;
(a -&gt; a -&gt; a) -&gt; f (Map k a) -&gt; Map k a
</span><span class="hs-identifier hs-var">M.unionsWith</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span> </span><span class="annot"><span class="annottext">([Map k a] -&gt; Map k a)
-&gt; (HHT v n a -&gt; [Map k a]) -&gt; HHT v n a -&gt; Map k a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(HHTLine v n a -&gt; [Map k a]) -&gt; [HHTLine v n a] -&gt; [Map k a]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">HHTLine v n a -&gt; [Map k a]
</span><a href="#local-6989586621679184315"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">([HHTLine v n a] -&gt; [Map k a])
-&gt; (HHT v n a -&gt; [HHTLine v n a]) -&gt; HHT v n a -&gt; [Map k a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HHT v n a -&gt; [HHTLine v n a]
forall (v :: * -&gt; *) (n :: Nat) a. HHT v n a -&gt; [HHTLine v n a]
</span><a href="Numeric.HHT.html#hhtLines"><span class="hs-identifier hs-var hs-var">hhtLines</span></a></span><span>
</span><span id="line-268"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-269"></span><span>    </span><span class="annot"><a href="#local-6989586621679184315"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Numeric.HHT.html#HHTLine"><span class="hs-identifier hs-type">HHTLine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184623"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184621"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184622"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679184620"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184622"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-270"></span><span>    </span><span id="local-6989586621679184315"><span class="annot"><span class="annottext">go :: HHTLine v n a -&gt; [Map k a]
</span><a href="#local-6989586621679184315"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679184312"><span id="local-6989586621679184313"><span id="local-6989586621679184314"><span class="annot"><a href="Numeric.HHT.html#HHTLine"><span class="hs-identifier hs-type">HHTLine</span></a></span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Finite n -&gt; Map k a) -&gt; [Finite n] -&gt; [Map k a])
-&gt; [Finite n] -&gt; (Finite n -&gt; Map k a) -&gt; [Map k a]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">(Finite n -&gt; Map k a) -&gt; [Finite n] -&gt; [Map k a]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KnownNat n =&gt; [Finite n]
forall (n :: Nat). KnownNat n =&gt; [Finite n]
</span><span class="hs-identifier hs-var">finites</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679184621"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Finite n -&gt; Map k a) -&gt; [Map k a])
-&gt; (Finite n -&gt; Map k a) -&gt; [Map k a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679184311"><span class="annot"><span class="annottext">i :: Finite n
</span><a href="#local-6989586621679184311"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-271"></span><span>      </span><span class="annot"><span class="annottext">k -&gt; a -&gt; Map k a
forall k a. k -&gt; a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.singleton</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; k
</span><a href="#local-6989586621679184316"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; k) -&gt; a -&gt; k
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector v n a
</span><a href="#local-6989586621679184313"><span class="hs-identifier hs-var">hlFreqs</span></a></span><span> </span><span class="annot"><span class="annottext">Vector v n a -&gt; Finite n -&gt; a
forall (v :: * -&gt; *) (n :: Nat) a.
Vector v a =&gt;
Vector v n a -&gt; Finite n -&gt; a
</span><span class="hs-operator hs-var">`SVG.index`</span></span><span> </span><span class="annot"><span class="annottext">Finite n
</span><a href="#local-6989586621679184311"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector v (n + 1) a
</span><a href="#local-6989586621679184314"><span class="hs-identifier hs-var">hlMags</span></a></span><span> </span><span class="annot"><span class="annottext">Vector v (n + 1) a -&gt; Finite (n + 1) -&gt; a
forall (v :: * -&gt; *) (n :: Nat) a.
Vector v a =&gt;
Vector v n a -&gt; Finite n -&gt; a
</span><span class="hs-operator hs-var">`SVG.index`</span></span><span> </span><span class="annot"><span class="annottext">Finite n -&gt; Finite (n + 1)
forall (n :: Nat). Finite n -&gt; Finite (n + 1)
</span><span class="hs-identifier hs-var">weaken</span></span><span> </span><span class="annot"><span class="annottext">Finite n
</span><a href="#local-6989586621679184311"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="hs-comment">-- | Compute the mean marginal spectrum given a Hilbert-Huang Transform. It</span><span>
</span><span id="line-274"></span><span class="hs-comment">-- is similar to a Fourier Transform; it provides the &quot;total power&quot; over</span><span>
</span><span id="line-275"></span><span class="hs-comment">-- the entire time series for each frequency component, averaged over the</span><span>
</span><span id="line-276"></span><span class="hs-comment">-- length of the time series.</span><span>
</span><span id="line-277"></span><span class="hs-comment">--</span><span>
</span><span id="line-278"></span><span class="hs-comment">-- A binning function is accepted to allow you to specify how specific you</span><span>
</span><span id="line-279"></span><span class="hs-comment">-- want your frequencies to be.</span><span>
</span><span id="line-280"></span><span class="hs-comment">--</span><span>
</span><span id="line-281"></span><span class="hs-comment">-- @since 0.1.8.0</span><span>
</span><span id="line-282"></span><span class="annot"><a href="Numeric.HHT.html#meanMarginal"><span class="hs-identifier hs-type">meanMarginal</span></a></span><span>
</span><span id="line-283"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679184588"><span class="annot"><a href="#local-6989586621679184588"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621679184586"><span class="annot"><a href="#local-6989586621679184586"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621679184587"><span class="annot"><a href="#local-6989586621679184587"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679184585"><span class="annot"><a href="#local-6989586621679184585"><span class="hs-identifier hs-type">k</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184588"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184587"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679184586"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679184585"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679184587"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679184587"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679184585"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span>     </span><span class="hs-comment">-- ^ binning function.  takes rev/tick freq between 0 and 1.</span><span>
</span><span id="line-285"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.HHT.html#HHT"><span class="hs-identifier hs-type">HHT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184588"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184586"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184587"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-286"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679184585"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184587"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-287"></span><span id="meanMarginal"><span class="annot"><span class="annottext">meanMarginal :: (a -&gt; k) -&gt; HHT v n a -&gt; Map k a
</span><a href="Numeric.HHT.html#meanMarginal"><span class="hs-identifier hs-var hs-var">meanMarginal</span></a></span></span><span> </span><span id="local-6989586621679184310"><span class="annot"><span class="annottext">f :: a -&gt; k
</span><a href="#local-6989586621679184310"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; Map k a -&gt; Map k a
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679184308"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Map k a -&gt; Map k a)
-&gt; (HHT v n a -&gt; Map k a) -&gt; HHT v n a -&gt; Map k a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; k) -&gt; HHT v n a -&gt; Map k a
forall (v :: * -&gt; *) (n :: Nat) a k.
(Vector v a, KnownNat n, Ord k, Num a) =&gt;
(a -&gt; k) -&gt; HHT v n a -&gt; Map k a
</span><a href="Numeric.HHT.html#marginal"><span class="hs-identifier hs-var">marginal</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; k
</span><a href="#local-6989586621679184310"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-288"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-289"></span><span>    </span><span id="local-6989586621679184308"><span class="annot"><span class="annottext">n :: a
</span><a href="#local-6989586621679184308"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; a
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Natural -&gt; a) -&gt; Natural -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Proxy n -&gt; Natural
forall (n :: Nat) (proxy :: Nat -&gt; *).
KnownNat n =&gt;
proxy n -&gt; Natural
</span><span class="hs-identifier hs-var">natVal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy n
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679184586"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span class="hs-comment">-- | Returns the &quot;expected value&quot; of frequency at each time step,</span><span>
</span><span id="line-292"></span><span class="hs-comment">-- calculated as a weighted average of all contributions at every frequency</span><span>
</span><span id="line-293"></span><span class="hs-comment">-- at that time step.</span><span>
</span><span id="line-294"></span><span class="hs-comment">--</span><span>
</span><span id="line-295"></span><span class="hs-comment">-- @since 0.1.4.0</span><span>
</span><span id="line-296"></span><span class="annot"><a href="Numeric.HHT.html#expectedFreq"><span class="hs-identifier hs-type">expectedFreq</span></a></span><span>
</span><span id="line-297"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679184305"><span class="annot"><a href="#local-6989586621679184305"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621679184304"><span class="annot"><a href="#local-6989586621679184304"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621679184303"><span class="annot"><a href="#local-6989586621679184303"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184305"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184303"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679184304"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679184303"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.HHT.html#HHT"><span class="hs-identifier hs-type">HHT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184305"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184304"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184303"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-299"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184305"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184304"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184303"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-300"></span><span id="expectedFreq"><span class="annot"><span class="annottext">expectedFreq :: HHT v n a -&gt; Vector v n a
</span><a href="Numeric.HHT.html#expectedFreq"><span class="hs-identifier hs-var hs-var">expectedFreq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; (Sum a, Sum a))
-&gt; ((Sum a, Sum a) -&gt; a) -&gt; HHT v n a -&gt; Vector v n a
forall (v :: * -&gt; *) (u :: * -&gt; *) (n :: Nat) a b c.
(Vector v a, Vector u c, KnownNat n, Monoid b) =&gt;
(a -&gt; a -&gt; b) -&gt; (b -&gt; c) -&gt; HHT v n a -&gt; Vector u n c
</span><a href="Numeric.HHT.html#foldFreq"><span class="hs-identifier hs-var">foldFreq</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679184302"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621679184302"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679184301"><span class="annot"><span class="annottext">y :: a
</span><a href="#local-6989586621679184301"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Sum a
forall a. a -&gt; Sum a
</span><span class="hs-identifier hs-var">Sum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679184302"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679184301"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; Sum a
forall a. a -&gt; Sum a
</span><span class="hs-identifier hs-var">Sum</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679184301"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Sum</span></span><span> </span><span id="local-6989586621679184299"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621679184299"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Sum</span></span><span> </span><span id="local-6989586621679184298"><span class="annot"><span class="annottext">y :: a
</span><a href="#local-6989586621679184298"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679184299"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679184298"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span class="hs-comment">-- | Returns the dominant frequency (frequency with largest magnitude</span><span>
</span><span id="line-303"></span><span class="hs-comment">-- contribution) at each time step.</span><span>
</span><span id="line-304"></span><span class="hs-comment">--</span><span>
</span><span id="line-305"></span><span class="hs-comment">-- @since 0.1.4.0</span><span>
</span><span id="line-306"></span><span class="annot"><a href="Numeric.HHT.html#dominantFreq"><span class="hs-identifier hs-type">dominantFreq</span></a></span><span>
</span><span id="line-307"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679184297"><span class="annot"><a href="#local-6989586621679184297"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621679184296"><span class="annot"><a href="#local-6989586621679184296"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621679184295"><span class="annot"><a href="#local-6989586621679184295"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184297"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184295"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679184296"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679184295"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.HHT.html#HHT"><span class="hs-identifier hs-type">HHT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184297"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184296"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184295"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-309"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184297"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184296"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184295"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-310"></span><span id="dominantFreq"><span class="annot"><span class="annottext">dominantFreq :: HHT v n a -&gt; Vector v n a
</span><a href="Numeric.HHT.html#dominantFreq"><span class="hs-identifier hs-var hs-var">dominantFreq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; Maybe (Max (Arg a a)))
-&gt; (Maybe (Max (Arg a a)) -&gt; a) -&gt; HHT v n a -&gt; Vector v n a
forall (v :: * -&gt; *) (u :: * -&gt; *) (n :: Nat) a b c.
(Vector v a, Vector u c, KnownNat n, Monoid b) =&gt;
(a -&gt; a -&gt; b) -&gt; (b -&gt; c) -&gt; HHT v n a -&gt; Vector u n c
</span><a href="Numeric.HHT.html#foldFreq"><span class="hs-identifier hs-var">foldFreq</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Maybe (Max (Arg a a))
</span><a href="#local-6989586621679184294"><span class="hs-identifier hs-var">comb</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Max (Arg a a)) -&gt; a
</span><a href="#local-6989586621679184293"><span class="hs-identifier hs-var">proj</span></a></span><span>
</span><span id="line-311"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-312"></span><span>    </span><span class="annot"><a href="#local-6989586621679184294"><span class="hs-identifier hs-type">comb</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679184295"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679184295"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Max</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Arg</span></span><span> </span><span class="annot"><a href="#local-6989586621679184295"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184295"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>    </span><span id="local-6989586621679184294"><span class="annot"><span class="annottext">comb :: a -&gt; a -&gt; Maybe (Max (Arg a a))
</span><a href="#local-6989586621679184294"><span class="hs-identifier hs-var hs-var">comb</span></a></span></span><span> </span><span id="local-6989586621679184292"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621679184292"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679184291"><span class="annot"><span class="annottext">y :: a
</span><a href="#local-6989586621679184291"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Max (Arg a a) -&gt; Maybe (Max (Arg a a))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Max (Arg a a) -&gt; Maybe (Max (Arg a a)))
-&gt; Max (Arg a a) -&gt; Maybe (Max (Arg a a))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Arg a a -&gt; Max (Arg a a)
forall a. a -&gt; Max a
</span><span class="hs-identifier hs-var">Max</span></span><span> </span><span class="annot"><span class="annottext">(Arg a a -&gt; Max (Arg a a)) -&gt; Arg a a -&gt; Max (Arg a a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Arg a a
forall a b. a -&gt; b -&gt; Arg a b
</span><span class="hs-identifier hs-var">Arg</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679184291"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679184292"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-314"></span><span>    </span><span class="annot"><a href="#local-6989586621679184293"><span class="hs-identifier hs-type">proj</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Max</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Arg</span></span><span> </span><span class="annot"><a href="#local-6989586621679184295"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184295"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679184295"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-315"></span><span>    </span><span id="local-6989586621679184293"><span class="annot"><span class="annottext">proj :: Maybe (Max (Arg a a)) -&gt; a
</span><a href="#local-6989586621679184293"><span class="hs-identifier hs-var hs-var">proj</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; a
forall a. String -&gt; a
</span><span class="hs-identifier hs-var">errorWithoutStackTrace</span></span><span>
</span><span id="line-316"></span><span>      </span><span class="annot"><span class="hs-string">&quot;Numeric.HHT.dominantFreq: HHT was formed with no Intrinsic Mode Functions&quot;</span></span><span>
</span><span id="line-317"></span><span>    </span><span class="annot"><a href="#local-6989586621679184293"><span class="hs-identifier hs-var">proj</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Max</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Arg</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679184287"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621679184287"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679184287"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span class="hs-comment">-- | Compute the instantaneous energy of the time series at every step via</span><span>
</span><span id="line-320"></span><span class="hs-comment">-- the Hilbert-Huang Transform.</span><span>
</span><span id="line-321"></span><span class="annot"><a href="Numeric.HHT.html#instantaneousEnergy"><span class="hs-identifier hs-type">instantaneousEnergy</span></a></span><span>
</span><span id="line-322"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679184286"><span class="annot"><a href="#local-6989586621679184286"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621679184285"><span class="annot"><a href="#local-6989586621679184285"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621679184284"><span class="annot"><a href="#local-6989586621679184284"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184286"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184284"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679184285"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679184284"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-323"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.HHT.html#HHT"><span class="hs-identifier hs-type">HHT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184286"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184285"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184284"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-324"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184286"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184285"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184284"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-325"></span><span id="instantaneousEnergy"><span class="annot"><span class="annottext">instantaneousEnergy :: HHT v n a -&gt; Vector v n a
</span><a href="Numeric.HHT.html#instantaneousEnergy"><span class="hs-identifier hs-var hs-var">instantaneousEnergy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; Sum a) -&gt; (Sum a -&gt; a) -&gt; HHT v n a -&gt; Vector v n a
forall (v :: * -&gt; *) (u :: * -&gt; *) (n :: Nat) a b c.
(Vector v a, Vector u c, KnownNat n, Monoid b) =&gt;
(a -&gt; a -&gt; b) -&gt; (b -&gt; c) -&gt; HHT v n a -&gt; Vector u n c
</span><a href="Numeric.HHT.html#foldFreq"><span class="hs-identifier hs-var">foldFreq</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679184283"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621679184283"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Sum a
forall a. a -&gt; Sum a
</span><span class="hs-identifier hs-var">Sum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679184283"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679184283"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Sum a -&gt; a
forall a. Sum a -&gt; a
</span><span class="hs-identifier hs-var hs-var">getSum</span></span><span>
</span><span id="line-326"></span><span>
</span><span id="line-327"></span><span class="hs-comment">-- | Degree of stationarity, as a function of frequency.</span><span>
</span><span id="line-328"></span><span class="annot"><a href="Numeric.HHT.html#degreeOfStationarity"><span class="hs-identifier hs-type">degreeOfStationarity</span></a></span><span>
</span><span id="line-329"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679184281"><span class="annot"><a href="#local-6989586621679184281"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621679184280"><span class="annot"><a href="#local-6989586621679184280"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621679184279"><span class="annot"><a href="#local-6989586621679184279"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679184278"><span class="annot"><a href="#local-6989586621679184278"><span class="hs-identifier hs-type">k</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184281"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184279"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679184280"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679184278"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679184279"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679184279"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-330"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679184279"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679184278"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span>     </span><span class="hs-comment">-- ^ binning function.  takes rev/tick freq between 0 and 1.</span><span>
</span><span id="line-331"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.HHT.html#HHT"><span class="hs-identifier hs-type">HHT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184281"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184280"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184279"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-332"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679184278"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184279"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-333"></span><span id="degreeOfStationarity"><span class="annot"><span class="annottext">degreeOfStationarity :: (a -&gt; k) -&gt; HHT v n a -&gt; Map k a
</span><a href="Numeric.HHT.html#degreeOfStationarity"><span class="hs-identifier hs-var hs-var">degreeOfStationarity</span></a></span></span><span> </span><span id="local-6989586621679184277"><span class="annot"><span class="annottext">f :: a -&gt; k
</span><a href="#local-6989586621679184277"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679184276"><span class="annot"><span class="annottext">h :: HHT v n a
</span><a href="#local-6989586621679184276"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; Map k a -&gt; Map k a
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679184275"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-334"></span><span>                         </span><span class="annot"><span class="annottext">(Map k a -&gt; Map k a)
-&gt; (HHT v n a -&gt; Map k a) -&gt; HHT v n a -&gt; Map k a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; [Map k a] -&gt; Map k a
forall (f :: * -&gt; *) k a.
(Foldable f, Ord k) =&gt;
(a -&gt; a -&gt; a) -&gt; f (Map k a) -&gt; Map k a
</span><span class="hs-identifier hs-var">M.unionsWith</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span>
</span><span id="line-335"></span><span>                         </span><span class="annot"><span class="annottext">([Map k a] -&gt; Map k a)
-&gt; (HHT v n a -&gt; [Map k a]) -&gt; HHT v n a -&gt; Map k a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(HHTLine v n a -&gt; [Map k a]) -&gt; [HHTLine v n a] -&gt; [Map k a]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">HHTLine v n a -&gt; [Map k a]
</span><a href="#local-6989586621679184274"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-336"></span><span>                         </span><span class="annot"><span class="annottext">([HHTLine v n a] -&gt; [Map k a])
-&gt; (HHT v n a -&gt; [HHTLine v n a]) -&gt; HHT v n a -&gt; [Map k a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HHT v n a -&gt; [HHTLine v n a]
forall (v :: * -&gt; *) (n :: Nat) a. HHT v n a -&gt; [HHTLine v n a]
</span><a href="Numeric.HHT.html#hhtLines"><span class="hs-identifier hs-var hs-var">hhtLines</span></a></span><span>
</span><span id="line-337"></span><span>                         </span><span class="annot"><span class="annottext">(HHT v n a -&gt; Map k a) -&gt; HHT v n a -&gt; Map k a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HHT v n a
</span><a href="#local-6989586621679184276"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-338"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-339"></span><span>    </span><span id="local-6989586621679184275"><span class="annot"><span class="annottext">n :: a
</span><a href="#local-6989586621679184275"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; a
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Natural -&gt; a) -&gt; Natural -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Proxy n -&gt; Natural
forall (n :: Nat) (proxy :: Nat -&gt; *).
KnownNat n =&gt;
proxy n -&gt; Natural
</span><span class="hs-identifier hs-var">natVal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy n
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679184280"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-340"></span><span>    </span><span id="local-6989586621679184273"><span class="annot"><span class="annottext">meanMarg :: Map k a
</span><a href="#local-6989586621679184273"><span class="hs-identifier hs-var hs-var">meanMarg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; k) -&gt; HHT v n a -&gt; Map k a
forall (v :: * -&gt; *) (n :: Nat) a k.
(Vector v a, KnownNat n, Ord k, Fractional a) =&gt;
(a -&gt; k) -&gt; HHT v n a -&gt; Map k a
</span><a href="Numeric.HHT.html#meanMarginal"><span class="hs-identifier hs-var">meanMarginal</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; k
</span><a href="#local-6989586621679184277"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">HHT v n a
</span><a href="#local-6989586621679184276"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-341"></span><span>    </span><span class="annot"><a href="#local-6989586621679184274"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Numeric.HHT.html#HHTLine"><span class="hs-identifier hs-type">HHTLine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184281"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184280"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184279"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679184278"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184279"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-342"></span><span>    </span><span id="local-6989586621679184274"><span class="annot"><span class="annottext">go :: HHTLine v n a -&gt; [Map k a]
</span><a href="#local-6989586621679184274"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679184270"><span id="local-6989586621679184271"><span id="local-6989586621679184272"><span class="annot"><a href="Numeric.HHT.html#HHTLine"><span class="hs-identifier hs-type">HHTLine</span></a></span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Finite n -&gt; Map k a) -&gt; [Finite n] -&gt; [Map k a])
-&gt; [Finite n] -&gt; (Finite n -&gt; Map k a) -&gt; [Map k a]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">(Finite n -&gt; Map k a) -&gt; [Finite n] -&gt; [Map k a]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KnownNat n =&gt; [Finite n]
forall (n :: Nat). KnownNat n =&gt; [Finite n]
</span><span class="hs-identifier hs-var">finites</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679184280"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Finite n -&gt; Map k a) -&gt; [Map k a])
-&gt; (Finite n -&gt; Map k a) -&gt; [Map k a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679184269"><span class="annot"><span class="annottext">i :: Finite n
</span><a href="#local-6989586621679184269"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-343"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679184268"><span class="annot"><span class="annottext">fr :: k
</span><a href="#local-6989586621679184268"><span class="hs-identifier hs-var hs-var">fr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; k
</span><a href="#local-6989586621679184277"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; k) -&gt; a -&gt; k
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector v n a
</span><a href="#local-6989586621679184271"><span class="hs-identifier hs-var">hlFreqs</span></a></span><span> </span><span class="annot"><span class="annottext">Vector v n a -&gt; Finite n -&gt; a
forall (v :: * -&gt; *) (n :: Nat) a.
Vector v a =&gt;
Vector v n a -&gt; Finite n -&gt; a
</span><span class="hs-operator hs-var">`SVG.index`</span></span><span> </span><span class="annot"><span class="annottext">Finite n
</span><a href="#local-6989586621679184269"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-344"></span><span>            </span><span id="local-6989586621679184267"><span class="annot"><span class="annottext">mm :: a
</span><a href="#local-6989586621679184267"><span class="hs-identifier hs-var hs-var">mm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679184273"><span class="hs-identifier hs-var">meanMarg</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a -&gt; k -&gt; a
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><span class="hs-operator hs-var">M.!</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679184268"><span class="hs-identifier hs-var">fr</span></a></span><span>
</span><span id="line-345"></span><span>        </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">k -&gt; a -&gt; Map k a
forall k a. k -&gt; a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.singleton</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679184268"><span class="hs-identifier hs-var">fr</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Map k a) -&gt; a -&gt; Map k a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-346"></span><span>              </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679184267"><span class="hs-identifier hs-var">mm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-347"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-348"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector v (n + 1) a
</span><a href="#local-6989586621679184272"><span class="hs-identifier hs-var">hlMags</span></a></span><span> </span><span class="annot"><span class="annottext">Vector v (n + 1) a -&gt; Finite (n + 1) -&gt; a
forall (v :: * -&gt; *) (n :: Nat) a.
Vector v a =&gt;
Vector v n a -&gt; Finite n -&gt; a
</span><span class="hs-operator hs-var">`SVG.index`</span></span><span> </span><span class="annot"><span class="annottext">Finite n -&gt; Finite (n + 1)
forall (n :: Nat). Finite n -&gt; Finite (n + 1)
</span><span class="hs-identifier hs-var">weaken</span></span><span> </span><span class="annot"><span class="annottext">Finite n
</span><a href="#local-6989586621679184269"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679184267"><span class="hs-identifier hs-var">mm</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-349"></span><span>
</span><span id="line-350"></span><span class="hs-comment">-- | Given a time series, return a time series of the /magnitude/ of the</span><span>
</span><span id="line-351"></span><span class="hs-comment">-- hilbert transform and the /frequency/ of the hilbert transform, in units</span><span>
</span><span id="line-352"></span><span class="hs-comment">-- of revolutions per tick.  Is only expected to taken in proper/legal</span><span>
</span><span id="line-353"></span><span class="hs-comment">-- IMFs.</span><span>
</span><span id="line-354"></span><span class="hs-comment">--</span><span>
</span><span id="line-355"></span><span class="hs-comment">-- The frequency will always be between 0 and 1, since we can't determine</span><span>
</span><span id="line-356"></span><span class="hs-comment">-- anything faster given the discretization, and we exclude negative values</span><span>
</span><span id="line-357"></span><span class="hs-comment">-- as physically unmeaningful for an IMF.</span><span>
</span><span id="line-358"></span><span class="annot"><a href="Numeric.HHT.html#hilbertMagFreq"><span class="hs-identifier hs-type">hilbertMagFreq</span></a></span><span>
</span><span id="line-359"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679184754"><span class="annot"><a href="#local-6989586621679184754"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621679184752"><span class="annot"><a href="#local-6989586621679184752"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621679184753"><span class="annot"><a href="#local-6989586621679184753"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184754"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184753"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184754"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Complex</span></span><span> </span><span class="annot"><a href="#local-6989586621679184753"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679184752"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FFT.FFTWReal</span></span><span> </span><span class="annot"><a href="#local-6989586621679184753"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-360"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184754"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679184752"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679184753"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-361"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SVG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184754"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679184752"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679184753"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SVG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184754"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184752"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184753"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679184753"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span id="hilbertMagFreq"><span class="annot"><span class="annottext">hilbertMagFreq :: Vector v (n + 1) a -&gt; (Vector v (n + 1) a, (Vector v n a, a))
</span><a href="Numeric.HHT.html#hilbertMagFreq"><span class="hs-identifier hs-var hs-var">hilbertMagFreq</span></a></span></span><span> </span><span id="local-6989586621679184264"><span class="annot"><span class="annottext">v :: Vector v (n + 1) a
</span><a href="#local-6989586621679184264"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector v (n + 1) a
</span><a href="#local-6989586621679184263"><span class="hs-identifier hs-var">hilbertMag</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector v n a
</span><a href="#local-6989586621679184262"><span class="hs-identifier hs-var">hilbertFreq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679184261"><span class="hs-identifier hs-var">&#966;0</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-363"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-364"></span><span>    </span><span id="local-6989586621679184260"><span class="annot"><span class="annottext">v' :: Vector v (n + 1) (Complex a)
</span><a href="#local-6989586621679184260"><span class="hs-identifier hs-var hs-var">v'</span></a></span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector v (n + 1) a -&gt; Vector v (n + 1) (Complex a)
forall (v :: * -&gt; *) (n :: Nat) a.
(Vector v a, Vector v (Complex a), KnownNat n, FFTWReal a) =&gt;
Vector v n a -&gt; Vector v n (Complex a)
</span><a href="Numeric.HHT.html#hilbert"><span class="hs-identifier hs-var">hilbert</span></a></span><span> </span><span class="annot"><span class="annottext">Vector v (n + 1) a
</span><a href="#local-6989586621679184264"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-365"></span><span>    </span><span id="local-6989586621679184263"><span class="annot"><span class="annottext">hilbertMag :: Vector v (n + 1) a
</span><a href="#local-6989586621679184263"><span class="hs-identifier hs-var hs-var">hilbertMag</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Complex a -&gt; a)
-&gt; Vector v (n + 1) (Complex a) -&gt; Vector v (n + 1) a
forall (v :: * -&gt; *) a b (n :: Nat).
(Vector v a, Vector v b) =&gt;
(a -&gt; b) -&gt; Vector v n a -&gt; Vector v n b
</span><span class="hs-identifier hs-var">SVG.map</span></span><span> </span><span class="annot"><span class="annottext">Complex a -&gt; a
forall a. RealFloat a =&gt; Complex a -&gt; a
</span><span class="hs-identifier hs-var">magnitude</span></span><span> </span><span class="annot"><span class="annottext">Vector v (n + 1) (Complex a)
</span><a href="#local-6989586621679184260"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-366"></span><span>    </span><span id="local-6989586621679184258"><span class="annot"><span class="annottext">hilbertPhase :: Vector v (n + 1) a
</span><a href="#local-6989586621679184258"><span class="hs-identifier hs-var hs-var">hilbertPhase</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Complex a -&gt; a)
-&gt; Vector v (n + 1) (Complex a) -&gt; Vector v (n + 1) a
forall (v :: * -&gt; *) a b (n :: Nat).
(Vector v a, Vector v b) =&gt;
(a -&gt; b) -&gt; Vector v n a -&gt; Vector v n b
</span><span class="hs-identifier hs-var">SVG.map</span></span><span> </span><span class="annot"><span class="annottext">Complex a -&gt; a
forall a. RealFloat a =&gt; Complex a -&gt; a
</span><span class="hs-identifier hs-var">phase</span></span><span> </span><span class="annot"><span class="annottext">Vector v (n + 1) (Complex a)
</span><a href="#local-6989586621679184260"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-367"></span><span>    </span><span id="local-6989586621679184261"><span class="annot"><span class="annottext">&#966;0 :: a
</span><a href="#local-6989586621679184261"><span class="hs-identifier hs-var hs-var">&#966;0</span></a></span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector v (1 + n) a -&gt; a
forall (v :: * -&gt; *) (n :: Nat) a.
Vector v a =&gt;
Vector v (1 + n) a -&gt; a
</span><span class="hs-identifier hs-var">SVG.head</span></span><span> </span><span class="annot"><span class="annottext">Vector v (n + 1) a
Vector v (1 + n) a
</span><a href="#local-6989586621679184258"><span class="hs-identifier hs-var">hilbertPhase</span></a></span><span>
</span><span id="line-368"></span><span>    </span><span id="local-6989586621679184262"><span class="annot"><span class="annottext">hilbertFreq :: Vector v n a
</span><a href="#local-6989586621679184262"><span class="hs-identifier hs-var hs-var">hilbertFreq</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; Vector v n a -&gt; Vector v n a
forall (v :: * -&gt; *) a b (n :: Nat).
(Vector v a, Vector v b) =&gt;
(a -&gt; b) -&gt; Vector v n a -&gt; Vector v n b
</span><span class="hs-identifier hs-var">SVG.map</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Real a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod'`</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; (a -&gt; a) -&gt; a -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Vector v n a -&gt; Vector v n a) -&gt; Vector v n a -&gt; Vector v n a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector v (1 + n) a -&gt; Vector v n a
forall (v :: * -&gt; *) (n :: Nat) a.
Vector v a =&gt;
Vector v (1 + n) a -&gt; Vector v n a
</span><span class="hs-identifier hs-var">SVG.tail</span></span><span> </span><span class="annot"><span class="annottext">Vector v (n + 1) a
Vector v (1 + n) a
</span><a href="#local-6989586621679184258"><span class="hs-identifier hs-var">hilbertPhase</span></a></span><span> </span><span class="annot"><span class="annottext">Vector v n a -&gt; Vector v n a -&gt; Vector v n a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Vector v (n + 1) a -&gt; Vector v n a
forall (v :: * -&gt; *) (n :: Nat) a.
Vector v a =&gt;
Vector v (n + 1) a -&gt; Vector v n a
</span><span class="hs-identifier hs-var">SVG.init</span></span><span> </span><span class="annot"><span class="annottext">Vector v (n + 1) a
</span><a href="#local-6989586621679184258"><span class="hs-identifier hs-var">hilbertPhase</span></a></span><span>
</span><span id="line-369"></span><span>
</span><span id="line-370"></span><span class="hs-comment">-- | The polar form of 'hilbert': returns the magnitude and phase of the</span><span>
</span><span id="line-371"></span><span class="hs-comment">-- discrete hilbert transform of a series.</span><span>
</span><span id="line-372"></span><span class="hs-comment">--</span><span>
</span><span id="line-373"></span><span class="hs-comment">-- The computation of magnitude is unique, but computing phase gives us</span><span>
</span><span id="line-374"></span><span class="hs-comment">-- some ambiguity.  The interpretation of the hilbert transform for</span><span>
</span><span id="line-375"></span><span class="hs-comment">-- instantaneous frequency is that the original series &quot;spirals&quot; around the</span><span>
</span><span id="line-376"></span><span class="hs-comment">-- complex plane as time progresses, like a helix.  So, we impose</span><span>
</span><span id="line-377"></span><span class="hs-comment">-- a constraint on the phase to uniquely determine it: \(\phi_{t+1}\) is</span><span>
</span><span id="line-378"></span><span class="hs-comment">-- the /minimal valid phase/ such that \(\phi_{t+1} \geq \phi_{t}\).  This</span><span>
</span><span id="line-379"></span><span class="hs-comment">-- enforces the phase to be monotonically increasing at the slowest</span><span>
</span><span id="line-380"></span><span class="hs-comment">-- possible detectable rate.</span><span>
</span><span id="line-381"></span><span class="hs-comment">--</span><span>
</span><span id="line-382"></span><span class="hs-comment">-- @since 0.1.6.0</span><span>
</span><span id="line-383"></span><span class="annot"><a href="Numeric.HHT.html#hilbertPolar"><span class="hs-identifier hs-type">hilbertPolar</span></a></span><span>
</span><span id="line-384"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679184252"><span class="annot"><a href="#local-6989586621679184252"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621679184251"><span class="annot"><a href="#local-6989586621679184251"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621679184250"><span class="annot"><a href="#local-6989586621679184250"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184252"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184250"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184252"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Complex</span></span><span> </span><span class="annot"><a href="#local-6989586621679184250"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679184251"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FFT.FFTWReal</span></span><span> </span><span class="annot"><a href="#local-6989586621679184250"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-385"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184252"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679184251"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679184250"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-386"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SVG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184252"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679184251"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679184250"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184252"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679184251"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679184250"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-387"></span><span id="hilbertPolar"><span class="annot"><span class="annottext">hilbertPolar :: Vector v (n + 1) a -&gt; (Vector v (n + 1) a, Vector v (n + 1) a)
</span><a href="Numeric.HHT.html#hilbertPolar"><span class="hs-identifier hs-var hs-var">hilbertPolar</span></a></span></span><span> </span><span id="local-6989586621679184249"><span class="annot"><span class="annottext">v :: Vector v (n + 1) a
</span><a href="#local-6989586621679184249"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector v (n + 1) a
</span><a href="#local-6989586621679184248"><span class="hs-identifier hs-var">hilbertMag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Vector v (n + 1) a
</span><a href="#local-6989586621679184247"><span class="hs-identifier hs-var">hilbertPhase</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-388"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-389"></span><span>    </span><span class="annot"><a href="#local-6989586621679184248"><span class="hs-identifier hs-type">hilbertMag</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184252"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679184251"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679184250"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-390"></span><span>    </span><span class="annot"><a href="#local-6989586621679184246"><span class="hs-identifier hs-type">hilbertFreq</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184252"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184251"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184250"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-391"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679184248"><span class="annot"><a href="#local-6989586621679184248"><span class="hs-identifier hs-var">hilbertMag</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679184246"><span class="annot"><span class="annottext">hilbertFreq :: Vector v n a
</span><a href="#local-6989586621679184246"><span class="hs-identifier hs-var">hilbertFreq</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679184245"><span class="annot"><span class="annottext">&#966;0 :: a
</span><a href="#local-6989586621679184245"><span class="hs-identifier hs-var">&#966;0</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector v (n + 1) a -&gt; (Vector v (n + 1) a, (Vector v n a, a))
forall (v :: * -&gt; *) (n :: Nat) a.
(Vector v a, Vector v (Complex a), KnownNat n, FFTWReal a) =&gt;
Vector v (n + 1) a -&gt; (Vector v (n + 1) a, (Vector v n a, a))
</span><a href="Numeric.HHT.html#hilbertMagFreq"><span class="hs-identifier hs-var">hilbertMagFreq</span></a></span><span> </span><span class="annot"><span class="annottext">Vector v (n + 1) a
</span><a href="#local-6989586621679184249"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-392"></span><span>    </span><span class="annot"><a href="#local-6989586621679184247"><span class="hs-identifier hs-type">hilbertPhase</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184252"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679184251"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679184250"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-393"></span><span>    </span><span id="local-6989586621679184247"><span class="annot"><span class="annottext">hilbertPhase :: Vector v (n + 1) a
</span><a href="#local-6989586621679184247"><span class="hs-identifier hs-var hs-var">hilbertPhase</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; a -&gt; Vector v n a -&gt; Vector v (1 + n) a
forall (v :: * -&gt; *) a b (n :: Nat).
(Vector v a, Vector v b) =&gt;
(a -&gt; b -&gt; a) -&gt; a -&gt; Vector v n b -&gt; Vector v (1 + n) a
</span><span class="hs-identifier hs-var">SVG.scanl'</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679184245"><span class="hs-identifier hs-var">&#966;0</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; Vector v n a -&gt; Vector v n a
forall (v :: * -&gt; *) a b (n :: Nat).
(Vector v a, Vector v b) =&gt;
(a -&gt; b) -&gt; Vector v n a -&gt; Vector v n b
</span><span class="hs-operator hs-var">`SVG.map`</span></span><span> </span><span class="annot"><span class="annottext">Vector v n a
</span><a href="#local-6989586621679184246"><span class="hs-identifier hs-var">hilbertFreq</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-394"></span><span>
</span><span id="line-395"></span><span class="hs-comment">-- | Real part is original series and imaginary part is hilbert transformed</span><span>
</span><span id="line-396"></span><span class="hs-comment">-- series.  Creates a &quot;helical&quot; form of the original series that rotates</span><span>
</span><span id="line-397"></span><span class="hs-comment">-- along the complex plane.</span><span>
</span><span id="line-398"></span><span class="hs-comment">--</span><span>
</span><span id="line-399"></span><span class="hs-comment">-- Note that since /0.1.7.0/, this uses the same algorithm as the matlab</span><span>
</span><span id="line-400"></span><span class="hs-comment">-- implementation &lt;https://www.mathworks.com/help/signal/ref/hilbert.html&gt;</span><span>
</span><span id="line-401"></span><span class="annot"><a href="Numeric.HHT.html#hilbert"><span class="hs-identifier hs-type">hilbert</span></a></span><span>
</span><span id="line-402"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679184577"><span class="annot"><a href="#local-6989586621679184577"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621679184575"><span class="annot"><a href="#local-6989586621679184575"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621679184576"><span class="annot"><a href="#local-6989586621679184576"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-403"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184577"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184576"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-404"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184577"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Complex</span></span><span> </span><span class="annot"><a href="#local-6989586621679184576"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-405"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679184575"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-406"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FFT.FFTWReal</span></span><span> </span><span class="annot"><a href="#local-6989586621679184576"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-407"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-408"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184577"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184575"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184576"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-409"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184577"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184575"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Complex</span></span><span> </span><span class="annot"><a href="#local-6989586621679184576"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-410"></span><span id="hilbert"><span class="annot"><span class="annottext">hilbert :: Vector v n a -&gt; Vector v n (Complex a)
</span><a href="Numeric.HHT.html#hilbert"><span class="hs-identifier hs-var hs-var">hilbert</span></a></span></span><span> </span><span id="local-6989586621679184244"><span class="annot"><span class="annottext">v :: Vector v n a
</span><a href="#local-6989586621679184244"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector v n (Complex a) -&gt; Vector v n (Complex a)
forall a (v :: * -&gt; *) (n :: Nat).
(FFTWReal a, Vector v (Complex a)) =&gt;
Vector v n (Complex a) -&gt; Vector v n (Complex a)
</span><a href="Numeric.HHT.Internal.FFT.html#ifft"><span class="hs-identifier hs-var">ifft</span></a></span><span> </span><span class="annot"><span class="annottext">Vector v n (Complex a)
</span><a href="#local-6989586621679184242"><span class="hs-identifier hs-var">u'</span></a></span><span>
</span><span id="line-411"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-412"></span><span>    </span><span id="local-6989586621679184241"><span class="annot"><span class="annottext">v' :: Vector v n (Complex a)
</span><a href="#local-6989586621679184241"><span class="hs-identifier hs-var hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Complex a) -&gt; Vector v n a -&gt; Vector v n (Complex a)
forall (v :: * -&gt; *) a b (n :: Nat).
(Vector v a, Vector v b) =&gt;
(a -&gt; b) -&gt; Vector v n a -&gt; Vector v n b
</span><span class="hs-identifier hs-var">SVG.map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; Complex a
forall a. a -&gt; a -&gt; Complex a
</span><span class="hs-operator hs-var">:+</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector v n a
</span><a href="#local-6989586621679184244"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-413"></span><span>    </span><span id="local-6989586621679184239"><span class="annot"><span class="annottext">u :: Vector v n (Complex a)
</span><a href="#local-6989586621679184239"><span class="hs-identifier hs-var hs-var">u</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector v n (Complex a) -&gt; Vector v n (Complex a)
forall a (v :: * -&gt; *) (n :: Nat).
(FFTWReal a, Vector v (Complex a)) =&gt;
Vector v n (Complex a) -&gt; Vector v n (Complex a)
</span><a href="Numeric.HHT.Internal.FFT.html#fft"><span class="hs-identifier hs-var">fft</span></a></span><span> </span><span class="annot"><span class="annottext">Vector v n (Complex a)
</span><a href="#local-6989586621679184241"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-414"></span><span>    </span><span id="local-6989586621679184242"><span class="annot"><span class="annottext">u' :: Vector v n (Complex a)
</span><a href="#local-6989586621679184242"><span class="hs-identifier hs-var hs-var">u'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Finite n -&gt; Complex a -&gt; Complex a)
 -&gt; Vector v n (Complex a) -&gt; Vector v n (Complex a))
-&gt; Vector v n (Complex a)
-&gt; (Finite n -&gt; Complex a -&gt; Complex a)
-&gt; Vector v n (Complex a)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">(Finite n -&gt; Complex a -&gt; Complex a)
-&gt; Vector v n (Complex a) -&gt; Vector v n (Complex a)
forall (v :: * -&gt; *) a b (n :: Nat).
(Vector v a, Vector v b) =&gt;
(Finite n -&gt; a -&gt; b) -&gt; Vector v n a -&gt; Vector v n b
</span><span class="hs-identifier hs-var">SVG.imap</span></span><span> </span><span class="annot"><span class="annottext">Vector v n (Complex a)
</span><a href="#local-6989586621679184239"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">((Finite n -&gt; Complex a -&gt; Complex a) -&gt; Vector v n (Complex a))
-&gt; (Finite n -&gt; Complex a -&gt; Complex a) -&gt; Vector v n (Complex a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Finite n -&gt; Natural
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span class="hs-glyph">-&gt;</span><span id="local-6989586621679184236"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679184236"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679184235"><span class="annot"><span class="annottext">x :: Complex a
</span><a href="#local-6989586621679184235"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-415"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679184236"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679184236"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679184233"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Natural
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Complex a
</span><a href="#local-6989586621679184235"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-416"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679184236"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679184233"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Natural
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Complex a -&gt; Complex a -&gt; Complex a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Complex a
</span><a href="#local-6989586621679184235"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-417"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-418"></span><span>    </span><span id="local-6989586621679184233"><span class="annot"><span class="annottext">n :: Natural
</span><a href="#local-6989586621679184233"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy n -&gt; Natural
forall (n :: Nat) (proxy :: Nat -&gt; *).
KnownNat n =&gt;
proxy n -&gt; Natural
</span><span class="hs-identifier hs-var">natVal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy n
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679184575"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-419"></span><span>
</span><span id="line-420"></span><span class="hs-comment">-- | Hilbert transformed series.  Essentially the same series, but</span><span>
</span><span id="line-421"></span><span class="hs-comment">-- phase-shifted 90 degrees.  Is so-named because it is the &quot;imaginary</span><span>
</span><span id="line-422"></span><span class="hs-comment">-- part&quot; of the proper hilbert transform, 'hilbert'.</span><span>
</span><span id="line-423"></span><span class="hs-comment">--</span><span>
</span><span id="line-424"></span><span class="hs-comment">-- Note that since /0.1.7.0/, this uses the same algorithm as the matlab</span><span>
</span><span id="line-425"></span><span class="hs-comment">-- implementation &lt;https://www.mathworks.com/help/signal/ref/hilbert.html&gt;</span><span>
</span><span id="line-426"></span><span class="annot"><a href="Numeric.HHT.html#hilbertIm"><span class="hs-identifier hs-type">hilbertIm</span></a></span><span>
</span><span id="line-427"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679184230"><span class="annot"><a href="#local-6989586621679184230"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621679184229"><span class="annot"><a href="#local-6989586621679184229"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621679184228"><span class="annot"><a href="#local-6989586621679184228"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-428"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184230"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184228"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-429"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184230"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Complex</span></span><span> </span><span class="annot"><a href="#local-6989586621679184228"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-430"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679184229"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-431"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FFT.FFTWReal</span></span><span> </span><span class="annot"><a href="#local-6989586621679184228"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-432"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-433"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184230"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184229"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184228"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-434"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVG.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679184230"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184229"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184228"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-435"></span><span id="hilbertIm"><span class="annot"><span class="annottext">hilbertIm :: Vector v n a -&gt; Vector v n a
</span><a href="Numeric.HHT.html#hilbertIm"><span class="hs-identifier hs-var hs-var">hilbertIm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Complex a -&gt; a) -&gt; Vector v n (Complex a) -&gt; Vector v n a
forall (v :: * -&gt; *) a b (n :: Nat).
(Vector v a, Vector v b) =&gt;
(a -&gt; b) -&gt; Vector v n a -&gt; Vector v n b
</span><span class="hs-identifier hs-var">SVG.map</span></span><span> </span><span class="annot"><span class="annottext">Complex a -&gt; a
forall a. Complex a -&gt; a
</span><span class="hs-identifier hs-var">imagPart</span></span><span> </span><span class="annot"><span class="annottext">(Vector v n (Complex a) -&gt; Vector v n a)
-&gt; (Vector v n a -&gt; Vector v n (Complex a))
-&gt; Vector v n a
-&gt; Vector v n a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vector v n a -&gt; Vector v n (Complex a)
forall (v :: * -&gt; *) (n :: Nat) a.
(Vector v a, Vector v (Complex a), KnownNat n, FFTWReal a) =&gt;
Vector v n a -&gt; Vector v n (Complex a)
</span><a href="Numeric.HHT.html#hilbert"><span class="hs-identifier hs-var">hilbert</span></a></span><span>
</span><span id="line-436"></span><span>
</span><span id="line-437"></span></pre></body></html>